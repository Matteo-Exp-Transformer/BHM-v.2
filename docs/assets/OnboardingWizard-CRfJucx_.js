import{j as a}from"./query-vendor-yChzfXyf.js";import{r as m,R as xe,a as hn,b as wa,d as oi}from"./react-vendor-C-olevxG.js";import{B as Te,u as Mt,r as An,f as Ca,M as li,z as ci,y as di,x as ot,g as lt,T as Qe,a as ja,C as ui,L as mi,V as $n,Y as Na,o as Fn,_ as fi,m as Pt,l as _r,e as pi,H as Sa,G as hi,$ as gi,d as xi,p as vi}from"./ui-vendor-Cbmmx1ZO.js";import{m as Se,t as bi,n as yi,M as wi,u as Ci,s as Ue}from"./calendar-features-CH9cZWS7.js";import{A as ce}from"./inventory-features-DUcsbGTp.js";import{u as ji}from"./router-vendor-Csqy7B6S.js";import"./calendar-vendor-DXaLcHZA.js";import"./auth-vendor-ColjAiDE.js";const Vn=(e,t)=>{try{if(t===void 0)return console.warn(`[SafeStorage] Tentativo di salvare undefined per chiave: ${e}`),!1;const n=JSON.stringify(t);return n==="undefined"||n==="null"?(console.warn(`[SafeStorage] Dati non serializzabili per chiave: ${e}`),!1):(localStorage.setItem(e,n),!0)}catch(n){return console.error(`[SafeStorage] Errore nel salvare ${e}:`,n),!1}},Ni=e=>{try{return localStorage.removeItem(e),!0}catch(t){return console.error(`[SafeStorage] Errore nel rimuovere ${e}:`,t),!1}},Si=()=>{try{return["onboarding-data","haccp-onboarding","haccp-onboarding-new","haccp-departments","haccp-staff","haccp-refrigerators","haccp-cleaning","haccp-products","haccp-temperatures","haccp-product-labels","haccp-users","haccp-current-user","haccp-last-check","haccp-last-sync","haccp-company-id"].forEach(t=>{Ni(t)}),console.log("[SafeStorage] Dati HACCP puliti con successo"),!0}catch(e){return console.error("[SafeStorage] Errore nella pulizia dati HACCP:",e),!1}},_i=()=>{try{return localStorage.clear(),sessionStorage.clear(),console.log("[SafeStorage] Storage pulito completamente"),!0}catch(e){return console.error("[SafeStorage] Errore nella pulizia completa:",e),!1}},Ai=e=>{const t=()=>`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n=[{manutenzione:"rilevamento_temperatura",frequenza:"giornaliera",assegnatoARuolo:"responsabile",assegnatoACategoria:"Banconisti",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Controllo temperatura giornaliero obbligatorio"},{manutenzione:"sanificazione",frequenza:"settimanale",assegnatoARuolo:"dipendente",assegnatoACategoria:"Cuochi",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Sanificazione settimanale completa"},{manutenzione:"sbrinamento",frequenza:"annuale",assegnatoARuolo:"admin",assegnatoACategoria:"Amministratore",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Sbrinamento annuale profondo"},{manutenzione:"controllo_scadenze",frequenza:"custom",assegnatoARuolo:"dipendente",assegnatoACategoria:"all",assegnatoADipendenteSpecifico:void 0,giorniCustom:["lunedi","giovedi"],note:"Controllo scadenze Lunedì e Giovedì"}],r=[];return e.forEach(s=>{n.forEach(i=>{s.pointType==="ambiente"&&i.manutenzione==="sbrinamento"||r.push({id:t(),conservationPointId:s.id,manutenzione:i.manutenzione,frequenza:i.frequenza,assegnatoARuolo:i.assegnatoARuolo,assegnatoACategoria:i.assegnatoACategoria,assegnatoADipendenteSpecifico:i.assegnatoADipendenteSpecifico,giorniCustom:i.giorniCustom,note:i.note})})}),r},_a=()=>{const e=()=>`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t=[{id:e(),name:"Cucina",description:"Area di preparazione e cottura cibi",is_active:!0},{id:e(),name:"Bancone",description:"Area di servizio clienti",is_active:!0},{id:e(),name:"Sala",description:"Area di servizio ai tavoli",is_active:!0},{id:e(),name:"Magazzino",description:"Area di stoccaggio merci",is_active:!0},{id:e(),name:"Magazzino B",description:"Area di stoccaggio secondaria",is_active:!0},{id:e(),name:"Sala B",description:"Area di servizio secondaria",is_active:!0},{id:e(),name:"Deoor / Esterno",description:"Area deoor e servizi esterni",is_active:!0},{id:e(),name:"Plonge / Lavaggio Piatti",description:"Area lavaggio stoviglie e piatti",is_active:!0}],n=l=>t.filter(c=>l.some(d=>c.name.toLowerCase().includes(d.toLowerCase()))).map(c=>c.id),r=()=>t.filter(l=>l.is_active).map(l=>l.id),s=l=>t.find(d=>d.name.toLowerCase().includes(l.toLowerCase()))?.id||"",i=[{id:e(),name:"Matteo",surname:"Cavallaro",fullName:"Matteo Cavallaro",role:"responsabile",categories:["Banconisti"],email:"Neo@gmail.com",phone:"3334578536",department_assignments:r(),haccpExpiry:"2025-10-01",notes:"Responsabile con accesso a tutti i reparti"},{id:e(),name:"Fabrizio",surname:"Dettori",fullName:"Fabrizio Dettori",role:"admin",categories:["Amministratore"],email:"Fabri@gmail.com",phone:"3334578535",department_assignments:n(["Sala","Sala B","Deoor","Plonge"]),haccpExpiry:"2026-10-01",notes:"Amministratore con accesso a Sala, Sala B, Deoor e Plonge"},{id:e(),name:"Paolo",surname:"Dettori",fullName:"Paolo Dettori",role:"admin",categories:["Cuochi","Amministratore"],email:"Pablo@gmail.com",phone:"3334578534",department_assignments:r(),haccpExpiry:"2025-10-01",notes:"Amministratore con competenze di cucina"},{id:e(),name:"Eddy",surname:"TheQueen",fullName:"Eddy TheQueen",role:"dipendente",categories:["Banconisti"],email:"Eddy@gmail.com",phone:"3334578533",department_assignments:n(["Bancone"]),haccpExpiry:"2026-10-01",notes:"Dipendente specializzato al bancone"},{id:e(),name:"Elena",surname:"Compagna",fullName:"Elena Compagna",role:"dipendente",categories:["Banconisti","Camerieri"],email:"Ele@gmail.com",phone:"3334578532",department_assignments:n(["Bancone","Sala","Sala B","Deoor","Plonge"]),haccpExpiry:"2026-10-01",notes:"Dipendente multiruolo con accesso a più reparti"}],o=[{id:e(),name:"Frigo A",departmentId:s("Cucina"),targetTemperature:4,pointType:"fridge",isBlastChiller:!1,productCategories:["fresh_meat","fresh_dairy"],source:"prefill"},{id:e(),name:"Freezer A",departmentId:s("Cucina"),targetTemperature:-18,pointType:"freezer",isBlastChiller:!1,productCategories:["frozen","deep_frozen"],source:"prefill"},{id:e(),name:"Freezer B",departmentId:s("Cucina"),targetTemperature:-20,pointType:"freezer",isBlastChiller:!1,productCategories:["frozen","deep_frozen"],source:"prefill"},{id:e(),name:"Abbattitore",departmentId:s("Cucina"),targetTemperature:-25,pointType:"blast",isBlastChiller:!0,productCategories:["blast_chilling"],source:"prefill"},{id:e(),name:"Frigo 1",departmentId:s("Bancone"),targetTemperature:2,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"],source:"prefill"},{id:e(),name:"Frigo 2",departmentId:s("Bancone"),targetTemperature:3,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"],source:"prefill"},{id:e(),name:"Frigo 3",departmentId:s("Bancone"),targetTemperature:5,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"],source:"prefill"}];return{business:{name:"Al Ritrovo SRL",address:"Via centotrecento 1/1b Bologna 40128",phone:"0511234567",email:"000@gmail.com",vat_number:"IT01234567890",business_type:"ristorante",established_date:"2020-01-15",license_number:"RIS-2020-001"},departments:t,staff:i,conservation:{points:o},tasks:{conservationMaintenancePlans:Ai(o),genericTasks:[{id:e(),name:"Pulizia approfondita cucina",frequenza:"settimanale",assegnatoARuolo:"dipendente",assegnatoACategoria:"Cuochi",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Pulizia e sanificazione completa area cucina ogni settimana"},{id:e(),name:"Controllo giacenze magazzino",frequenza:"settimanale",assegnatoARuolo:"responsabile",assegnatoACategoria:void 0,assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Verifica inventario e ordini settimanali"},{id:e(),name:"Pulizia bancone servizio",frequenza:"giornaliera",assegnatoARuolo:"dipendente",assegnatoACategoria:"Banconisti",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Sanificazione quotidiana bancone e attrezzature"},{id:e(),name:"Controllo e pulizia sala",frequenza:"giornaliera",assegnatoARuolo:"dipendente",assegnatoACategoria:"Camerieri",assegnatoADipendenteSpecifico:void 0,giorniCustom:void 0,note:"Pulizia tavoli, pavimenti e controllo generale sala"}],generalTasks:[],maintenanceTasks:[]},inventory:{categories:[{id:e(),name:"Carni Fresche",color:"#ef4444",conservationRules:{minTemp:0,maxTemp:4,maxStorageDays:3,requiresBlastChilling:!0}},{id:e(),name:"Pesce Fresco",color:"#3b82f6",conservationRules:{minTemp:0,maxTemp:2,maxStorageDays:2,requiresBlastChilling:!0}},{id:e(),name:"Latticini",color:"#f59e0b",conservationRules:{minTemp:2,maxTemp:6,maxStorageDays:7}},{id:e(),name:"Verdure Fresche",color:"#10b981",conservationRules:{minTemp:4,maxTemp:8,maxStorageDays:5}}],products:[{id:e(),name:"Pomodori San Marzano",quantity:5,unit:"kg",supplierName:"Ortofrutta Napoletana",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+4*24*60*60*1e3).toISOString().split("T")[0],status:"active",allergens:[]},{id:e(),name:"Mozzarella di Bufala",quantity:10,unit:"pz",allergens:[ce.LATTE],supplierName:"Caseificio Campano",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+5*24*60*60*1e3).toISOString().split("T")[0],status:"active"},{id:e(),name:"Petto di Pollo",quantity:2.5,unit:"kg",supplierName:"Carni Locali SRL",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+3*24*60*60*1e3).toISOString().split("T")[0],status:"active",allergens:[]},{id:e(),name:"Salmone Fresco",quantity:1.8,unit:"kg",allergens:[ce.PESCE],supplierName:"Pescheria del Porto",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+2*24*60*60*1e3).toISOString().split("T")[0],status:"active"},{id:e(),name:"Olio Extravergine",quantity:5,unit:"l",supplierName:"Frantoio Toscano",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+365*24*60*60*1e3).toISOString().split("T")[0],status:"active",allergens:[]},{id:e(),name:"Pasta di Grano Duro",quantity:20,unit:"conf",allergens:[ce.GLUTINE],supplierName:"Pastificio Artigianale",purchaseDate:new Date().toISOString().split("T")[0],expiryDate:new Date(Date.now()+730*24*60*60*1e3).toISOString().split("T")[0],status:"active"}]}}},Ti=()=>{console.log("🔄 Precompilazione onboarding...");try{_i();const e=_a();if(e.departments?.length){const t=e.departments.find(r=>r.name==="Cucina")?.id,n=e.departments.find(r=>r.name==="Bancone")?.id;if(e.conservation?.points&&(e.conservation.points=e.conservation.points.map(r=>({...r,departmentId:r.name.includes("Cucina")?t||"":r.name.includes("Bancone")?n||"":e.departments?.[0]?.id||""}))),e.staff&&(e.staff=e.staff.map(r=>({...r,department_assignments:r.categories.includes("Responsabile Sala")?[n||""]:r.categories.includes("Cuochi")?[t||""]:[e.departments?.[0]?.id||""]}))),e.inventory?.categories?.length){const r=e.inventory.categories.find(c=>c.name==="Carni Fresche")?.id,s=e.inventory.categories.find(c=>c.name==="Pesce Fresco")?.id,i=e.inventory.categories.find(c=>c.name==="Latticini")?.id,o=e.inventory.categories.find(c=>c.name==="Verdure Fresche")?.id,l=e.conservation?.points?.find(c=>c.name.includes("Frigo"))?.id;e.inventory.products&&(e.inventory.products=e.inventory.products.map(c=>({...c,categoryId:c.name.includes("Pollo")?r:c.name.includes("Salmone")?s:c.name.includes("Mozzarella")?i:c.name.includes("Pomodori")?o:void 0,departmentId:t,conservationPointId:l})))}}Vn("onboarding-data",e),console.log("✅ Onboarding precompilato con successo:",e),Te.success("Onboarding precompilato con dati di Al Ritrovo SRL!",{position:"top-right",autoClose:3e3})}catch(e){console.error("❌ Errore nella precompilazione:",e),Te.error("Errore durante la precompilazione",{position:"top-right",autoClose:3e3})}},Ei=()=>{if(!window.confirm(`⚠️ ATTENZIONE!

Questa operazione cancellerà TUTTI i dati dell'onboarding e dell'app.

Sei sicuro di voler continuare?`)){console.log("🔄 Reset onboarding annullato dall'utente");return}console.log("🔄 Reset completo onboarding...");try{Si(),console.log("✅ Reset onboarding completato con successo"),Te.success("Onboarding resettato completamente!",{position:"top-right",autoClose:3e3}),setTimeout(()=>{window.location.reload()},1e3)}catch(t){console.error("❌ Errore nel reset onboarding:",t),Te.error("Errore durante il reset",{position:"top-right",autoClose:3e3})}},Ri=()=>{console.log("🔄 Completamento automatico onboarding...");try{localStorage.getItem("onboarding-data")||Ti(),Vn("onboarding-completed",!0),Vn("onboarding-completed-at",new Date().toISOString()),console.log("✅ Onboarding completato automaticamente"),Te.success("Onboarding completato automaticamente!",{position:"top-right",autoClose:3e3}),setTimeout(()=>{window.location.href="/"},1e3)}catch(e){console.error("❌ Errore nel completamento automatico:",e),Te.error("Errore durante il completamento automatico",{position:"top-right",autoClose:3e3})}},ki=["ristorante","bar","pizzeria","trattoria","osteria","enoteca","birreria","altro"],Ii=({data:e,onUpdate:t,onValidChange:n})=>{const[r,s]=m.useState({name:"",address:"",phone:"",email:"",vat_number:"",business_type:"",established_date:"",license_number:"",...e}),[i,o]=m.useState({});m.useEffect(()=>{s(u=>({...u,...e}))},[e]);const l=(u,x)=>{const b={...r,[u]:x};s(b),t(b)};m.useEffect(()=>{const u=r,x={};u.name.trim()?u.name.trim().length<2&&(x.name="Il nome deve essere di almeno 2 caratteri"):x.name="Il nome dell'azienda è obbligatorio",u.address.trim()||(x.address="L'indirizzo è obbligatorio"),u.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)&&(x.email="Inserisci un indirizzo email valido"),u.phone&&!/^[+]?[0-9\s\-()]+$/.test(u.phone)&&(x.phone="Inserisci un numero di telefono valido"),u.vat_number&&!/^IT[0-9]{11}$/.test(u.vat_number.replace(/\s/g,""))&&(x.vat_number="Inserisci una Partita IVA valida (es: IT12345678901)"),o(x),n(Object.keys(x).length===0&&!!u.name.trim()&&!!u.address.trim())},[r,n]);const c=(u,x)=>{l(u,x)},d=()=>{const u={name:"Al Ritrovo SRL",address:"Via Roma 123, 40121 Bologna BO",phone:"+39 051 1234567",email:"info@alritrovo.it",vat_number:"IT01234567890",business_type:"ristorante",established_date:"2020-01-15",license_number:"RIS-2020-001"};s(u),t(u)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Mt,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informazioni Aziendali"}),a.jsx("p",{className:"text-gray-600",children:"Inserisci i dati principali della tua azienda per configurare il sistema HACCP"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"🚀 Compila con dati di esempio"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Nome Azienda *"]}),a.jsx("input",{type:"text",value:r.name,onChange:u=>c("name",u.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.name?"border-red-300":"border-gray-300"}`,placeholder:"Inserisci il nome della tua azienda"}),i.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.name})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(An,{className:"w-4 h-4 mr-2"}),"Tipo di Attività"]}),a.jsxs("select",{value:r.business_type,onChange:u=>c("business_type",u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Seleziona tipo di attività"}),ki.map(u=>a.jsx("option",{value:u,children:u.charAt(0).toUpperCase()+u.slice(1)},u))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(Ca,{className:"w-4 h-4 mr-2"}),"Data di Apertura"]}),a.jsx("input",{type:"date",value:r.established_date,onChange:u=>c("established_date",u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(li,{className:"w-4 h-4 mr-2"}),"Indirizzo *"]}),a.jsx("textarea",{value:r.address,onChange:u=>c("address",u.target.value),rows:3,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.address?"border-red-300":"border-gray-300"}`,placeholder:"Inserisci l'indirizzo completo dell'azienda"}),i.address&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.address})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(ci,{className:"w-4 h-4 mr-2"}),"Telefono"]}),a.jsx("input",{type:"tel",value:r.phone,onChange:u=>c("phone",u.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.phone?"border-red-300":"border-gray-300"}`,placeholder:"+39 051 1234567"}),i.phone&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.phone})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(di,{className:"w-4 h-4 mr-2"}),"Email"]}),a.jsx("input",{type:"email",value:r.email,onChange:u=>c("email",u.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.email?"border-red-300":"border-gray-300"}`,placeholder:"info@azienda.it"}),i.email&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.email})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(An,{className:"w-4 h-4 mr-2"}),"Partita IVA"]}),a.jsx("input",{type:"text",value:r.vat_number,onChange:u=>c("vat_number",u.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.vat_number?"border-red-300":"border-gray-300"}`,placeholder:"IT12345678901"}),i.vat_number&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.vat_number})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[a.jsx(An,{className:"w-4 h-4 mr-2"}),"Numero Licenza"]}),a.jsx("input",{type:"text",value:r.license_number,onChange:u=>c("license_number",u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"RIS-2024-001"})]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"ℹ️ Conformità HACCP"}),a.jsx("p",{className:"text-sm text-blue-700",children:"Le informazioni inserite verranno utilizzate per configurare il sistema HACCP in conformità alle normative vigenti. I campi obbligatori sono necessari per garantire la tracciabilità e la compliance."})]})]})},Pi=({data:e,onUpdate:t,onValidChange:n})=>{const r=e||[],[s,i]=m.useState(null),[o,l]=m.useState({name:"",description:"",is_active:!0}),[c,d]=m.useState({});m.useEffect(()=>{const h=r.length>0&&r.every(j=>j.name.trim().length>=2&&!r.find(A=>A.id!==j.id&&A.name.toLowerCase()===j.name.toLowerCase()));n(h)},[r,n]);const u=()=>`dept_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x=()=>{const h={};if(o.name.trim()?o.name.trim().length<2?h.name="Il nome deve essere di almeno 2 caratteri":r.find(j=>j.name.toLowerCase()===o.name.toLowerCase())&&(h.name="Un reparto con questo nome esiste già"):h.name="Il nome del reparto è obbligatorio",d(h),Object.keys(h).length===0){const j={id:u(),name:o.name.trim(),description:o.description.trim(),is_active:o.is_active};t([...r,j]),l({name:"",description:"",is_active:!0})}},b=()=>{const h={};o.name.trim()?o.name.trim().length<2?h.name="Il nome deve essere di almeno 2 caratteri":r.find(j=>j.id!==s&&j.name.toLowerCase()===o.name.toLowerCase())&&(h.name="Un reparto con questo nome esiste già"):h.name="Il nome del reparto è obbligatorio",d(h),Object.keys(h).length===0&&(t(r.map(j=>j.id===s?{...j,name:o.name.trim(),description:o.description.trim(),is_active:o.is_active}:j)),i(null),l({name:"",description:"",is_active:!0}))},C=h=>{t(r.filter(j=>j.id!==h))},w=h=>{i(h.id),l({name:h.name,description:h.description??"",is_active:h.is_active??!0}),d({})},f=()=>{i(null),l({name:"",description:"",is_active:!0}),d({})},v=()=>{const h=[{id:u(),name:"Cucina",description:"Area di preparazione dei cibi",is_active:!0},{id:u(),name:"Bancone",description:"Area servizio al bancone",is_active:!0},{id:u(),name:"Sala",description:"Area servizio ai tavoli",is_active:!0},{id:u(),name:"Magazzino",description:"Deposito merci e prodotti",is_active:!0},{id:u(),name:"Lavaggio",description:"Area lavaggio stoviglie",is_active:!0},{id:u(),name:"Deoor / Esterno",description:"Area deoor e servizi esterni",is_active:!0},{id:u(),name:"Plonge / Lavaggio Piatti",description:"Area lavaggio stoviglie e piatti",is_active:!0}];t(h)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Mt,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Configurazione Reparti"}),a.jsx("p",{className:"text-gray-600",children:"Definisci i reparti della tua azienda per organizzare staff, attrezzature e controlli"})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"🚀 Carica reparti predefiniti"})}),a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:s?"Modifica Reparto":"Aggiungi Nuovo Reparto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Reparto *"}),a.jsx("input",{type:"text",value:o.name,onChange:h=>l({...o,name:h.target.value}),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.name?"border-red-300":"border-gray-300"}`,placeholder:"es. Cucina, Sala, Bancone..."}),c.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrizione"}),a.jsx("input",{type:"text",value:o.description,onChange:h=>l({...o,description:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descrizione del reparto..."})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:o.is_active,onChange:h=>l({...o,is_active:h.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Reparto attivo"})]}),a.jsxs("div",{className:"flex gap-2",children:[s&&a.jsx("button",{type:"button",onClick:f,className:"px-3 py-2 text-sm text-gray-600 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Annulla"}),a.jsx("button",{type:"button",onClick:s?b:x,className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:s?a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"w-4 h-4"}),"Aggiorna"]}):a.jsxs(a.Fragment,{children:[a.jsx(lt,{className:"w-4 h-4"}),"Aggiungi"]})})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-3",children:["Reparti Configurati (",r.length,")"]}),r.length===0?a.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(Mt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500 mb-2",children:"Nessun reparto configurato"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Aggiungi almeno un reparto per continuare"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(h=>a.jsx("div",{className:`border rounded-lg p-4 ${h.is_active?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:h.name}),h.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.description}),a.jsx("div",{className:"flex items-center mt-2",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${h.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:h.is_active?"Attivo":"Inattivo"})})]}),a.jsxs("div",{className:"flex gap-2 ml-4",children:[a.jsx("button",{onClick:()=>w(h),className:"p-1 text-blue-600 hover:text-blue-800",title:"Modifica reparto",children:a.jsx(ot,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>C(h.id),className:"p-1 text-red-600 hover:text-red-800",title:"Elimina reparto",children:a.jsx(Qe,{className:"w-4 h-4"})})]})]})},h.id))})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"ℹ️ Organizzazione HACCP"}),a.jsx("p",{className:"text-sm text-blue-700",children:"I reparti sono utilizzati per organizzare il personale, assegnare responsabilità e configurare punti di controllo specifici. Ogni reparto può avere le proprie procedure HACCP e controlli di temperatura."})]})]})},Oi=(e,t="onboarding-form")=>{const n=m.useRef(null),r=m.useRef(!1),s=m.useCallback(()=>{e&&n.current&&window.requestAnimationFrame(()=>{n.current?.scrollIntoView({behavior:"smooth",block:"center"})})},[e]);return m.useEffect(()=>{e&&!r.current?(r.current=!0,s()):e||(r.current=!1)},[e,s]),m.useEffect(()=>{if(!t)return;const i=document.getElementById(t);return i&&(n.current=i),()=>{n.current&&n.current.id===t&&(n.current=null)}},[t]),{formRef:n,scrollToForm:s}},Ar={variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},re=xe.forwardRef(({className:e,variant:t="default",size:n="default",...r},s)=>a.jsx("button",{className:Se("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",Ar.variant[t],Ar.size[n],e),ref:s,...r}));re.displayName="Button";const Ve=xe.forwardRef(({className:e,type:t,...n},r)=>a.jsx("input",{type:t,className:Se("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...n}));Ve.displayName="Input";const K=xe.forwardRef(({className:e,...t},n)=>a.jsx("label",{ref:n,className:Se("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));K.displayName="Label";function Tr(e,[t,n]){return Math.min(n,Math.max(t,e))}function de(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e?.(s),n===!1||!s.defaultPrevented)return t?.(s)}}function fr(e,t=[]){let n=[];function r(i,o){const l=m.createContext(o),c=n.length;n=[...n,o];const d=x=>{const{scope:b,children:C,...w}=x,f=b?.[e]?.[c]||l,v=m.useMemo(()=>w,Object.values(w));return a.jsx(f.Provider,{value:v,children:C})};d.displayName=i+"Provider";function u(x,b){const C=b?.[e]?.[c]||l,w=m.useContext(C);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[d,u]}const s=()=>{const i=n.map(o=>m.createContext(o));return function(l){const c=l?.[e]||i;return m.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,Di(s,...t)]}function Di(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:d})=>{const x=c(i)[`__scope${d}`];return{...l,...x}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}function Er(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Aa(...e){return t=>{let n=!1;const r=e.map(s=>{const i=Er(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Er(e[s],null)}}}}function me(...e){return m.useCallback(Aa(...e),e)}function tn(e){const t=zi(e),n=m.forwardRef((r,s)=>{const{children:i,...o}=r,l=m.Children.toArray(i),c=l.find(Li);if(c){const d=c.props.children,u=l.map(x=>x===c?m.Children.count(d)>1?m.Children.only(null):m.isValidElement(d)?d.props.children:null:x);return a.jsx(t,{...o,ref:s,children:m.isValidElement(d)?m.cloneElement(d,void 0,u):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function zi(e){const t=m.forwardRef((n,r)=>{const{children:s,...i}=n;if(m.isValidElement(s)){const o=$i(s),l=Bi(i,s.props);return s.type!==m.Fragment&&(l.ref=r?Aa(r,o):o),m.cloneElement(s,l)}return m.Children.count(s)>1?m.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Mi=Symbol("radix.slottable");function Li(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Mi}function Bi(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function $i(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Fi(e){const t=e+"CollectionProvider",[n,r]=fr(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:v,children:h}=f,j=xe.useRef(null),A=xe.useRef(new Map).current;return a.jsx(s,{scope:v,itemMap:A,collectionRef:j,children:h})};o.displayName=t;const l=e+"CollectionSlot",c=tn(l),d=xe.forwardRef((f,v)=>{const{scope:h,children:j}=f,A=i(l,h),y=me(v,A.collectionRef);return a.jsx(c,{ref:y,children:j})});d.displayName=l;const u=e+"CollectionItemSlot",x="data-radix-collection-item",b=tn(u),C=xe.forwardRef((f,v)=>{const{scope:h,children:j,...A}=f,y=xe.useRef(null),T=me(v,y),S=i(u,h);return xe.useEffect(()=>(S.itemMap.set(y,{ref:y,...A}),()=>void S.itemMap.delete(y))),a.jsx(b,{[x]:"",ref:T,children:j})});C.displayName=u;function w(f){const v=i(e+"CollectionConsumer",f);return xe.useCallback(()=>{const j=v.collectionRef.current;if(!j)return[];const A=Array.from(j.querySelectorAll(`[${x}]`));return Array.from(v.itemMap.values()).sort((S,_)=>A.indexOf(S.ref.current)-A.indexOf(_.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:d,ItemSlot:C},w,r]}var Vi=m.createContext(void 0);function qi(e){const t=m.useContext(Vi);return e||t||"ltr"}var Hi=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],se=Hi.reduce((e,t)=>{const n=tn(`Primitive.${t}`),r=m.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function Zi(e,t){e&&hn.flushSync(()=>e.dispatchEvent(t))}function ct(e){const t=m.useRef(e);return m.useEffect(()=>{t.current=e}),m.useMemo(()=>(...n)=>t.current?.(...n),[])}function Ui(e,t=globalThis?.document){const n=ct(e);m.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Wi="DismissableLayer",qn="dismissableLayer.update",Gi="dismissableLayer.pointerDownOutside",Yi="dismissableLayer.focusOutside",Rr,Ta=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ea=m.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,d=m.useContext(Ta),[u,x]=m.useState(null),b=u?.ownerDocument??globalThis?.document,[,C]=m.useState({}),w=me(t,_=>x(_)),f=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),h=f.indexOf(v),j=u?f.indexOf(u):-1,A=d.layersWithOutsidePointerEventsDisabled.size>0,y=j>=h,T=Qi(_=>{const N=_.target,P=[...d.branches].some(L=>L.contains(N));!y||P||(s?.(_),o?.(_),_.defaultPrevented||l?.())},b),S=Ji(_=>{const N=_.target;[...d.branches].some(L=>L.contains(N))||(i?.(_),o?.(_),_.defaultPrevented||l?.())},b);return Ui(_=>{j===d.layers.size-1&&(r?.(_),!_.defaultPrevented&&l&&(_.preventDefault(),l()))},b),m.useEffect(()=>{if(u)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(Rr=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),kr(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=Rr)}},[u,b,n,d]),m.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),kr())},[u,d]),m.useEffect(()=>{const _=()=>C({});return document.addEventListener(qn,_),()=>document.removeEventListener(qn,_)},[]),a.jsx(se.div,{...c,ref:w,style:{pointerEvents:A?y?"auto":"none":void 0,...e.style},onFocusCapture:de(e.onFocusCapture,S.onFocusCapture),onBlurCapture:de(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:de(e.onPointerDownCapture,T.onPointerDownCapture)})});Ea.displayName=Wi;var Ki="DismissableLayerBranch",Xi=m.forwardRef((e,t)=>{const n=m.useContext(Ta),r=m.useRef(null),s=me(t,r);return m.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(se.div,{...e,ref:s})});Xi.displayName=Ki;function Qi(e,t=globalThis?.document){const n=ct(e),r=m.useRef(!1),s=m.useRef(()=>{});return m.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){Ra(Gi,n,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Ji(e,t=globalThis?.document){const n=ct(e),r=m.useRef(!1);return m.useEffect(()=>{const s=i=>{i.target&&!r.current&&Ra(Yi,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function kr(){const e=new CustomEvent(qn);document.dispatchEvent(e)}function Ra(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?Zi(s,i):s.dispatchEvent(i)}var Tn=0;function eo(){m.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Ir()),document.body.insertAdjacentElement("beforeend",e[1]??Ir()),Tn++,()=>{Tn===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Tn--}},[])}function Ir(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var En="focusScope.autoFocusOnMount",Rn="focusScope.autoFocusOnUnmount",Pr={bubbles:!1,cancelable:!0},to="FocusScope",ka=m.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[l,c]=m.useState(null),d=ct(s),u=ct(i),x=m.useRef(null),b=me(t,f=>c(f)),C=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(r){let f=function(A){if(C.paused||!l)return;const y=A.target;l.contains(y)?x.current=y:We(x.current,{select:!0})},v=function(A){if(C.paused||!l)return;const y=A.relatedTarget;y!==null&&(l.contains(y)||We(x.current,{select:!0}))},h=function(A){if(document.activeElement===document.body)for(const T of A)T.removedNodes.length>0&&We(l)};document.addEventListener("focusin",f),document.addEventListener("focusout",v);const j=new MutationObserver(h);return l&&j.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",f),document.removeEventListener("focusout",v),j.disconnect()}}},[r,l,C.paused]),m.useEffect(()=>{if(l){Dr.add(C);const f=document.activeElement;if(!l.contains(f)){const h=new CustomEvent(En,Pr);l.addEventListener(En,d),l.dispatchEvent(h),h.defaultPrevented||(no(oo(Ia(l)),{select:!0}),document.activeElement===f&&We(l))}return()=>{l.removeEventListener(En,d),setTimeout(()=>{const h=new CustomEvent(Rn,Pr);l.addEventListener(Rn,u),l.dispatchEvent(h),h.defaultPrevented||We(f??document.body,{select:!0}),l.removeEventListener(Rn,u),Dr.remove(C)},0)}}},[l,d,u,C]);const w=m.useCallback(f=>{if(!n&&!r||C.paused)return;const v=f.key==="Tab"&&!f.altKey&&!f.ctrlKey&&!f.metaKey,h=document.activeElement;if(v&&h){const j=f.currentTarget,[A,y]=ro(j);A&&y?!f.shiftKey&&h===y?(f.preventDefault(),n&&We(A,{select:!0})):f.shiftKey&&h===A&&(f.preventDefault(),n&&We(y,{select:!0})):h===j&&f.preventDefault()}},[n,r,C.paused]);return a.jsx(se.div,{tabIndex:-1,...o,ref:b,onKeyDown:w})});ka.displayName=to;function no(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(We(r,{select:t}),document.activeElement!==n)return}function ro(e){const t=Ia(e),n=Or(t,e),r=Or(t.reverse(),e);return[n,r]}function Ia(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Or(e,t){for(const n of e)if(!ao(n,{upTo:t}))return n}function ao(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function so(e){return e instanceof HTMLInputElement&&"select"in e}function We(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&so(e)&&t&&e.select()}}var Dr=io();function io(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=zr(e,t),e.unshift(t)},remove(t){e=zr(e,t),e[0]?.resume()}}}function zr(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function oo(e){return e.filter(t=>t.tagName!=="A")}var ge=globalThis?.document?m.useLayoutEffect:()=>{},lo=wa[" useId ".trim().toString()]||(()=>{}),co=0;function pr(e){const[t,n]=m.useState(lo());return ge(()=>{n(r=>r??String(co++))},[e]),e||(t?`radix-${t}`:"")}const uo=["top","right","bottom","left"],Je=Math.min,ve=Math.max,nn=Math.round,Ht=Math.floor,De=e=>({x:e,y:e}),mo={left:"right",right:"left",bottom:"top",top:"bottom"},fo={start:"end",end:"start"};function Hn(e,t,n){return ve(e,Je(t,n))}function qe(e,t){return typeof e=="function"?e(t):e}function He(e){return e.split("-")[0]}function Et(e){return e.split("-")[1]}function hr(e){return e==="x"?"y":"x"}function gr(e){return e==="y"?"height":"width"}const po=new Set(["top","bottom"]);function Oe(e){return po.has(He(e))?"y":"x"}function xr(e){return hr(Oe(e))}function ho(e,t,n){n===void 0&&(n=!1);const r=Et(e),s=xr(e),i=gr(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=rn(o)),[o,rn(o)]}function go(e){const t=rn(e);return[Zn(e),t,Zn(t)]}function Zn(e){return e.replace(/start|end/g,t=>fo[t])}const Mr=["left","right"],Lr=["right","left"],xo=["top","bottom"],vo=["bottom","top"];function bo(e,t,n){switch(e){case"top":case"bottom":return n?t?Lr:Mr:t?Mr:Lr;case"left":case"right":return t?xo:vo;default:return[]}}function yo(e,t,n,r){const s=Et(e);let i=bo(He(e),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(Zn)))),i}function rn(e){return e.replace(/left|right|bottom|top/g,t=>mo[t])}function wo(e){return{top:0,right:0,bottom:0,left:0,...e}}function Pa(e){return typeof e!="number"?wo(e):{top:e,right:e,bottom:e,left:e}}function an(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function Br(e,t,n){let{reference:r,floating:s}=e;const i=Oe(t),o=xr(t),l=gr(o),c=He(t),d=i==="y",u=r.x+r.width/2-s.width/2,x=r.y+r.height/2-s.height/2,b=r[l]/2-s[l]/2;let C;switch(c){case"top":C={x:u,y:r.y-s.height};break;case"bottom":C={x:u,y:r.y+r.height};break;case"right":C={x:r.x+r.width,y:x};break;case"left":C={x:r.x-s.width,y:x};break;default:C={x:r.x,y:r.y}}switch(Et(t)){case"start":C[o]-=b*(n&&d?-1:1);break;case"end":C[o]+=b*(n&&d?-1:1);break}return C}const Co=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:x}=Br(d,r,c),b=r,C={},w=0;for(let f=0;f<l.length;f++){const{name:v,fn:h}=l[f],{x:j,y:A,data:y,reset:T}=await h({x:u,y:x,initialPlacement:r,placement:b,strategy:s,middlewareData:C,rects:d,platform:o,elements:{reference:e,floating:t}});u=j??u,x=A??x,C={...C,[v]:{...C[v],...y}},T&&w<=50&&(w++,typeof T=="object"&&(T.placement&&(b=T.placement),T.rects&&(d=T.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):T.rects),{x:u,y:x}=Br(d,b,c)),f=-1)}return{x:u,y:x,placement:b,strategy:s,middlewareData:C}};async function Lt(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:x="floating",altBoundary:b=!1,padding:C=0}=qe(t,e),w=Pa(C),v=l[b?x==="floating"?"reference":"floating":x],h=an(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),j=x==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,A=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),y=await(i.isElement==null?void 0:i.isElement(A))?await(i.getScale==null?void 0:i.getScale(A))||{x:1,y:1}:{x:1,y:1},T=an(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:j,offsetParent:A,strategy:c}):j);return{top:(h.top-T.top+w.top)/y.y,bottom:(T.bottom-h.bottom+w.bottom)/y.y,left:(h.left-T.left+w.left)/y.x,right:(T.right-h.right+w.right)/y.x}}const jo=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=qe(e,t)||{};if(d==null)return{};const x=Pa(u),b={x:n,y:r},C=xr(s),w=gr(C),f=await o.getDimensions(d),v=C==="y",h=v?"top":"left",j=v?"bottom":"right",A=v?"clientHeight":"clientWidth",y=i.reference[w]+i.reference[C]-b[C]-i.floating[w],T=b[C]-i.reference[C],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let _=S?S[A]:0;(!_||!await(o.isElement==null?void 0:o.isElement(S)))&&(_=l.floating[A]||i.floating[w]);const N=y/2-T/2,P=_/2-f[w]/2-1,L=Je(x[h],P),$=Je(x[j],P),F=L,E=_-f[w]-$,p=_/2-f[w]/2+N,g=Hn(F,p,E),R=!c.arrow&&Et(s)!=null&&p!==g&&i.reference[w]/2-(p<F?L:$)-f[w]/2<0,O=R?p<F?p-F:p-E:0;return{[C]:b[C]+O,data:{[C]:g,centerOffset:p-g-O,...R&&{alignmentOffset:O}},reset:R}}}),No=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:f=!0,...v}=qe(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const h=He(s),j=Oe(l),A=He(l)===l,y=await(c.isRTL==null?void 0:c.isRTL(d.floating)),T=b||(A||!f?[rn(l)]:go(l)),S=w!=="none";!b&&S&&T.push(...yo(l,f,w,y));const _=[l,...T],N=await Lt(t,v),P=[];let L=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&P.push(N[h]),x){const p=ho(s,o,y);P.push(N[p[0]],N[p[1]])}if(L=[...L,{placement:s,overflows:P}],!P.every(p=>p<=0)){var $,F;const p=((($=i.flip)==null?void 0:$.index)||0)+1,g=_[p];if(g&&(!(x==="alignment"?j!==Oe(g):!1)||L.every(I=>Oe(I.placement)===j?I.overflows[0]>0:!0)))return{data:{index:p,overflows:L},reset:{placement:g}};let R=(F=L.filter(O=>O.overflows[0]<=0).sort((O,I)=>O.overflows[1]-I.overflows[1])[0])==null?void 0:F.placement;if(!R)switch(C){case"bestFit":{var E;const O=(E=L.filter(I=>{if(S){const z=Oe(I.placement);return z===j||z==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(z=>z>0).reduce((z,Z)=>z+Z,0)]).sort((I,z)=>I[1]-z[1])[0])==null?void 0:E[0];O&&(R=O);break}case"initialPlacement":R=l;break}if(s!==R)return{reset:{placement:R}}}return{}}}};function $r(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Fr(e){return uo.some(t=>e[t]>=0)}const So=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=qe(e,t);switch(r){case"referenceHidden":{const i=await Lt(t,{...s,elementContext:"reference"}),o=$r(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Fr(o)}}}case"escaped":{const i=await Lt(t,{...s,altBoundary:!0}),o=$r(i,n.floating);return{data:{escapedOffsets:o,escaped:Fr(o)}}}default:return{}}}}},Oa=new Set(["left","top"]);async function _o(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=He(n),l=Et(n),c=Oe(n)==="y",d=Oa.has(o)?-1:1,u=i&&c?-1:1,x=qe(t,e);let{mainAxis:b,crossAxis:C,alignmentAxis:w}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return l&&typeof w=="number"&&(C=l==="end"?w*-1:w),c?{x:C*u,y:b*d}:{x:b*d,y:C*u}}const Ao=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=t,c=await _o(t,e);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},To=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:v=>{let{x:h,y:j}=v;return{x:h,y:j}}},...c}=qe(e,t),d={x:n,y:r},u=await Lt(t,c),x=Oe(He(s)),b=hr(x);let C=d[b],w=d[x];if(i){const v=b==="y"?"top":"left",h=b==="y"?"bottom":"right",j=C+u[v],A=C-u[h];C=Hn(j,C,A)}if(o){const v=x==="y"?"top":"left",h=x==="y"?"bottom":"right",j=w+u[v],A=w-u[h];w=Hn(j,w,A)}const f=l.fn({...t,[b]:C,[x]:w});return{...f,data:{x:f.x-n,y:f.y-r,enabled:{[b]:i,[x]:o}}}}}},Eo=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=qe(e,t),u={x:n,y:r},x=Oe(s),b=hr(x);let C=u[b],w=u[x];const f=qe(l,t),v=typeof f=="number"?{mainAxis:f,crossAxis:0}:{mainAxis:0,crossAxis:0,...f};if(c){const A=b==="y"?"height":"width",y=i.reference[b]-i.floating[A]+v.mainAxis,T=i.reference[b]+i.reference[A]-v.mainAxis;C<y?C=y:C>T&&(C=T)}if(d){var h,j;const A=b==="y"?"width":"height",y=Oa.has(He(s)),T=i.reference[x]-i.floating[A]+(y&&((h=o.offset)==null?void 0:h[x])||0)+(y?0:v.crossAxis),S=i.reference[x]+i.reference[A]+(y?0:((j=o.offset)==null?void 0:j[x])||0)-(y?v.crossAxis:0);w<T?w=T:w>S&&(w=S)}return{[b]:C,[x]:w}}}},Ro=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...d}=qe(e,t),u=await Lt(t,d),x=He(s),b=Et(s),C=Oe(s)==="y",{width:w,height:f}=i.floating;let v,h;x==="top"||x==="bottom"?(v=x,h=b===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(h=x,v=b==="end"?"top":"bottom");const j=f-u.top-u.bottom,A=w-u.left-u.right,y=Je(f-u[v],j),T=Je(w-u[h],A),S=!t.middlewareData.shift;let _=y,N=T;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=A),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(_=j),S&&!b){const L=ve(u.left,0),$=ve(u.right,0),F=ve(u.top,0),E=ve(u.bottom,0);C?N=w-2*(L!==0||$!==0?L+$:ve(u.left,u.right)):_=f-2*(F!==0||E!==0?F+E:ve(u.top,u.bottom))}await c({...t,availableWidth:N,availableHeight:_});const P=await o.getDimensions(l.floating);return w!==P.width||f!==P.height?{reset:{rects:!0}}:{}}}};function gn(){return typeof window<"u"}function Rt(e){return Da(e)?(e.nodeName||"").toLowerCase():"#document"}function ye(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Le(e){var t;return(t=(Da(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Da(e){return gn()?e instanceof Node||e instanceof ye(e).Node:!1}function ke(e){return gn()?e instanceof Element||e instanceof ye(e).Element:!1}function Me(e){return gn()?e instanceof HTMLElement||e instanceof ye(e).HTMLElement:!1}function Vr(e){return!gn()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ye(e).ShadowRoot}const ko=new Set(["inline","contents"]);function Vt(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Ie(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!ko.has(s)}const Io=new Set(["table","td","th"]);function Po(e){return Io.has(Rt(e))}const Oo=[":popover-open",":modal"];function xn(e){return Oo.some(t=>{try{return e.matches(t)}catch{return!1}})}const Do=["transform","translate","scale","rotate","perspective"],zo=["transform","translate","scale","rotate","perspective","filter"],Mo=["paint","layout","strict","content"];function vr(e){const t=br(),n=ke(e)?Ie(e):e;return Do.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||zo.some(r=>(n.willChange||"").includes(r))||Mo.some(r=>(n.contain||"").includes(r))}function Lo(e){let t=et(e);for(;Me(t)&&!Ct(t);){if(vr(t))return t;if(xn(t))return null;t=et(t)}return null}function br(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Bo=new Set(["html","body","#document"]);function Ct(e){return Bo.has(Rt(e))}function Ie(e){return ye(e).getComputedStyle(e)}function vn(e){return ke(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function et(e){if(Rt(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Vr(e)&&e.host||Le(e);return Vr(t)?t.host:t}function za(e){const t=et(e);return Ct(t)?e.ownerDocument?e.ownerDocument.body:e.body:Me(t)&&Vt(t)?t:za(t)}function Bt(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=za(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),o=ye(s);if(i){const l=Un(o);return t.concat(o,o.visualViewport||[],Vt(s)?s:[],l&&n?Bt(l):[])}return t.concat(s,Bt(s,[],n))}function Un(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ma(e){const t=Ie(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Me(e),i=s?e.offsetWidth:n,o=s?e.offsetHeight:r,l=nn(n)!==i||nn(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function yr(e){return ke(e)?e:e.contextElement}function bt(e){const t=yr(e);if(!Me(t))return De(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=Ma(t);let o=(i?nn(n.width):n.width)/r,l=(i?nn(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const $o=De(0);function La(e){const t=ye(e);return!br()||!t.visualViewport?$o:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Fo(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ye(e)?!1:t}function dt(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=yr(e);let o=De(1);t&&(r?ke(r)&&(o=bt(r)):o=bt(e));const l=Fo(i,n,r)?La(i):De(0);let c=(s.left+l.x)/o.x,d=(s.top+l.y)/o.y,u=s.width/o.x,x=s.height/o.y;if(i){const b=ye(i),C=r&&ke(r)?ye(r):r;let w=b,f=Un(w);for(;f&&r&&C!==w;){const v=bt(f),h=f.getBoundingClientRect(),j=Ie(f),A=h.left+(f.clientLeft+parseFloat(j.paddingLeft))*v.x,y=h.top+(f.clientTop+parseFloat(j.paddingTop))*v.y;c*=v.x,d*=v.y,u*=v.x,x*=v.y,c+=A,d+=y,w=ye(f),f=Un(w)}}return an({width:u,height:x,x:c,y:d})}function bn(e,t){const n=vn(e).scrollLeft;return t?t.left+n:dt(Le(e)).left+n}function Ba(e,t){const n=e.getBoundingClientRect(),r=n.left+t.scrollLeft-bn(e,n),s=n.top+t.scrollTop;return{x:r,y:s}}function Vo(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",o=Le(r),l=t?xn(t.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},d=De(1);const u=De(0),x=Me(r);if((x||!x&&!i)&&((Rt(r)!=="body"||Vt(o))&&(c=vn(r)),Me(r))){const C=dt(r);d=bt(r),u.x=C.x+r.clientLeft,u.y=C.y+r.clientTop}const b=o&&!x&&!i?Ba(o,c):De(0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-c.scrollLeft*d.x+u.x+b.x,y:n.y*d.y-c.scrollTop*d.y+u.y+b.y}}function qo(e){return Array.from(e.getClientRects())}function Ho(e){const t=Le(e),n=vn(e),r=e.ownerDocument.body,s=ve(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=ve(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+bn(e);const l=-n.scrollTop;return Ie(r).direction==="rtl"&&(o+=ve(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}const qr=25;function Zo(e,t){const n=ye(e),r=Le(e),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=br();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const d=bn(r);if(d<=0){const u=r.ownerDocument,x=u.body,b=getComputedStyle(x),C=u.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,w=Math.abs(r.clientWidth-x.clientWidth-C);w<=qr&&(i-=w)}else d<=qr&&(i+=d);return{width:i,height:o,x:l,y:c}}const Uo=new Set(["absolute","fixed"]);function Wo(e,t){const n=dt(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Me(e)?bt(e):De(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,d=r*i.y;return{width:o,height:l,x:c,y:d}}function Hr(e,t,n){let r;if(t==="viewport")r=Zo(e,n);else if(t==="document")r=Ho(Le(e));else if(ke(t))r=Wo(t,n);else{const s=La(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return an(r)}function $a(e,t){const n=et(e);return n===t||!ke(n)||Ct(n)?!1:Ie(n).position==="fixed"||$a(n,t)}function Go(e,t){const n=t.get(e);if(n)return n;let r=Bt(e,[],!1).filter(l=>ke(l)&&Rt(l)!=="body"),s=null;const i=Ie(e).position==="fixed";let o=i?et(e):e;for(;ke(o)&&!Ct(o);){const l=Ie(o),c=vr(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&Uo.has(s.position)||Vt(o)&&!c&&$a(e,o))?r=r.filter(u=>u!==o):s=l,o=et(o)}return t.set(e,r),r}function Yo(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const o=[...n==="clippingAncestors"?xn(t)?[]:Go(t,this._c):[].concat(n),r],l=o[0],c=o.reduce((d,u)=>{const x=Hr(t,u,s);return d.top=ve(x.top,d.top),d.right=Je(x.right,d.right),d.bottom=Je(x.bottom,d.bottom),d.left=ve(x.left,d.left),d},Hr(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Ko(e){const{width:t,height:n}=Ma(e);return{width:t,height:n}}function Xo(e,t,n){const r=Me(t),s=Le(t),i=n==="fixed",o=dt(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=De(0);function d(){c.x=bn(s)}if(r||!r&&!i)if((Rt(t)!=="body"||Vt(s))&&(l=vn(t)),r){const C=dt(t,!0,i,t);c.x=C.x+t.clientLeft,c.y=C.y+t.clientTop}else s&&d();i&&!r&&s&&d();const u=s&&!r&&!i?Ba(s,l):De(0),x=o.left+l.scrollLeft-c.x-u.x,b=o.top+l.scrollTop-c.y-u.y;return{x,y:b,width:o.width,height:o.height}}function kn(e){return Ie(e).position==="static"}function Zr(e,t){if(!Me(e)||Ie(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Le(e)===n&&(n=n.ownerDocument.body),n}function Fa(e,t){const n=ye(e);if(xn(e))return n;if(!Me(e)){let s=et(e);for(;s&&!Ct(s);){if(ke(s)&&!kn(s))return s;s=et(s)}return n}let r=Zr(e,t);for(;r&&Po(r)&&kn(r);)r=Zr(r,t);return r&&Ct(r)&&kn(r)&&!vr(r)?n:r||Lo(e)||n}const Qo=async function(e){const t=this.getOffsetParent||Fa,n=this.getDimensions,r=await n(e.floating);return{reference:Xo(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Jo(e){return Ie(e).direction==="rtl"}const el={convertOffsetParentRelativeRectToViewportRelativeRect:Vo,getDocumentElement:Le,getClippingRect:Yo,getOffsetParent:Fa,getElementRects:Qo,getClientRects:qo,getDimensions:Ko,getScale:bt,isElement:ke,isRTL:Jo};function Va(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function tl(e,t){let n=null,r;const s=Le(e);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:x,width:b,height:C}=d;if(l||t(),!b||!C)return;const w=Ht(x),f=Ht(s.clientWidth-(u+b)),v=Ht(s.clientHeight-(x+C)),h=Ht(u),A={rootMargin:-w+"px "+-f+"px "+-v+"px "+-h+"px",threshold:ve(0,Je(1,c))||1};let y=!0;function T(S){const _=S[0].intersectionRatio;if(_!==c){if(!y)return o();_?o(!1,_):r=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!Va(d,e.getBoundingClientRect())&&o(),y=!1}try{n=new IntersectionObserver(T,{...A,root:s.ownerDocument})}catch{n=new IntersectionObserver(T,A)}n.observe(e)}return o(!0),i}function nl(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,d=yr(e),u=s||i?[...d?Bt(d):[],...Bt(t)]:[];u.forEach(h=>{s&&h.addEventListener("scroll",n,{passive:!0}),i&&h.addEventListener("resize",n)});const x=d&&l?tl(d,n):null;let b=-1,C=null;o&&(C=new ResizeObserver(h=>{let[j]=h;j&&j.target===d&&C&&(C.unobserve(t),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var A;(A=C)==null||A.observe(t)})),n()}),d&&!c&&C.observe(d),C.observe(t));let w,f=c?dt(e):null;c&&v();function v(){const h=dt(e);f&&!Va(f,h)&&n(),f=h,w=requestAnimationFrame(v)}return n(),()=>{var h;u.forEach(j=>{s&&j.removeEventListener("scroll",n),i&&j.removeEventListener("resize",n)}),x?.(),(h=C)==null||h.disconnect(),C=null,c&&cancelAnimationFrame(w)}}const rl=Ao,al=To,sl=No,il=Ro,ol=So,Ur=jo,ll=Eo,cl=(e,t,n)=>{const r=new Map,s={platform:el,...n},i={...s.platform,_c:r};return Co(e,t,{...s,platform:i})};var dl=typeof document<"u",ul=function(){},Xt=dl?m.useLayoutEffect:ul;function sn(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!sn(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!sn(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function qa(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Wr(e,t){const n=qa(e);return Math.round(t*n)/n}function In(e){const t=m.useRef(e);return Xt(()=>{t.current=e}),t}function ml(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,x]=m.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[b,C]=m.useState(r);sn(b,r)||C(r);const[w,f]=m.useState(null),[v,h]=m.useState(null),j=m.useCallback(I=>{I!==S.current&&(S.current=I,f(I))},[]),A=m.useCallback(I=>{I!==_.current&&(_.current=I,h(I))},[]),y=i||w,T=o||v,S=m.useRef(null),_=m.useRef(null),N=m.useRef(u),P=c!=null,L=In(c),$=In(s),F=In(d),E=m.useCallback(()=>{if(!S.current||!_.current)return;const I={placement:t,strategy:n,middleware:b};$.current&&(I.platform=$.current),cl(S.current,_.current,I).then(z=>{const Z={...z,isPositioned:F.current!==!1};p.current&&!sn(N.current,Z)&&(N.current=Z,hn.flushSync(()=>{x(Z)}))})},[b,t,n,$,F]);Xt(()=>{d===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,x(I=>({...I,isPositioned:!1})))},[d]);const p=m.useRef(!1);Xt(()=>(p.current=!0,()=>{p.current=!1}),[]),Xt(()=>{if(y&&(S.current=y),T&&(_.current=T),y&&T){if(L.current)return L.current(y,T,E);E()}},[y,T,E,L,P]);const g=m.useMemo(()=>({reference:S,floating:_,setReference:j,setFloating:A}),[j,A]),R=m.useMemo(()=>({reference:y,floating:T}),[y,T]),O=m.useMemo(()=>{const I={position:n,left:0,top:0};if(!R.floating)return I;const z=Wr(R.floating,u.x),Z=Wr(R.floating,u.y);return l?{...I,transform:"translate("+z+"px, "+Z+"px)",...qa(R.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:z,top:Z}},[n,l,R.floating,u.x,u.y]);return m.useMemo(()=>({...u,update:E,refs:g,elements:R,floatingStyles:O}),[u,E,g,R,O])}const fl=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Ur({element:r.current,padding:s}).fn(n):{}:r?Ur({element:r,padding:s}).fn(n):{}}}},pl=(e,t)=>({...rl(e),options:[e,t]}),hl=(e,t)=>({...al(e),options:[e,t]}),gl=(e,t)=>({...ll(e),options:[e,t]}),xl=(e,t)=>({...sl(e),options:[e,t]}),vl=(e,t)=>({...il(e),options:[e,t]}),bl=(e,t)=>({...ol(e),options:[e,t]}),yl=(e,t)=>({...fl(e),options:[e,t]});var wl="Arrow",Ha=m.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return a.jsx(se.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});Ha.displayName=wl;var Cl=Ha;function jl(e){const[t,n]=m.useState(void 0);return ge(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=e.offsetWidth,l=e.offsetHeight;n({width:o,height:l})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var wr="Popper",[Za,Ua]=fr(wr),[Nl,Wa]=Za(wr),Ga=e=>{const{__scopePopper:t,children:n}=e,[r,s]=m.useState(null);return a.jsx(Nl,{scope:t,anchor:r,onAnchorChange:s,children:n})};Ga.displayName=wr;var Ya="PopperAnchor",Ka=m.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Wa(Ya,n),o=m.useRef(null),l=me(t,o),c=m.useRef(null);return m.useEffect(()=>{const d=c.current;c.current=r?.current||o.current,d!==c.current&&i.onAnchorChange(c.current)}),r?null:a.jsx(se.div,{...s,ref:l})});Ka.displayName=Ya;var Cr="PopperContent",[Sl,_l]=Za(Cr),Xa=m.forwardRef((e,t)=>{const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:C="optimized",onPlaced:w,...f}=e,v=Wa(Cr,n),[h,j]=m.useState(null),A=me(t,V=>j(V)),[y,T]=m.useState(null),S=jl(y),_=S?.width??0,N=S?.height??0,P=r+(i!=="center"?"-"+i:""),L=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},$=Array.isArray(d)?d:[d],F=$.length>0,E={padding:L,boundary:$.filter(Tl),altBoundary:F},{refs:p,floatingStyles:g,placement:R,isPositioned:O,middlewareData:I}=ml({strategy:"fixed",placement:P,whileElementsMounted:(...V)=>nl(...V,{animationFrame:C==="always"}),elements:{reference:v.anchor},middleware:[pl({mainAxis:s+N,alignmentAxis:o}),c&&hl({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?gl():void 0,...E}),c&&xl({...E}),vl({...E,apply:({elements:V,rects:ee,availableWidth:pe,availableHeight:X})=>{const{width:te,height:oe}=ee.reference,Ce=V.floating.style;Ce.setProperty("--radix-popper-available-width",`${pe}px`),Ce.setProperty("--radix-popper-available-height",`${X}px`),Ce.setProperty("--radix-popper-anchor-width",`${te}px`),Ce.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),y&&yl({element:y,padding:l}),El({arrowWidth:_,arrowHeight:N}),b&&bl({strategy:"referenceHidden",...E})]}),[z,Z]=es(R),Q=ct(w);ge(()=>{O&&Q?.()},[O,Q]);const ne=I.arrow?.x,J=I.arrow?.y,ue=I.arrow?.centerOffset!==0,[ie,fe]=m.useState();return ge(()=>{h&&fe(window.getComputedStyle(h).zIndex)},[h]),a.jsx("div",{ref:p.setFloating,"data-radix-popper-content-wrapper":"",style:{...g,transform:O?g.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ie,"--radix-popper-transform-origin":[I.transformOrigin?.x,I.transformOrigin?.y].join(" "),...I.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(Sl,{scope:n,placedSide:z,onArrowChange:T,arrowX:ne,arrowY:J,shouldHideArrow:ue,children:a.jsx(se.div,{"data-side":z,"data-align":Z,...f,ref:A,style:{...f.style,animation:O?void 0:"none"}})})})});Xa.displayName=Cr;var Qa="PopperArrow",Al={top:"bottom",right:"left",bottom:"top",left:"right"},Ja=m.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=_l(Qa,r),o=Al[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(Cl,{...s,ref:n,style:{...s.style,display:"block"}})})});Ja.displayName=Qa;function Tl(e){return e!==null}var El=e=>({name:"transformOrigin",options:e,fn(t){const{placement:n,rects:r,middlewareData:s}=t,o=s.arrow?.centerOffset!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,u]=es(n),x={start:"0%",center:"50%",end:"100%"}[u],b=(s.arrow?.x??0)+l/2,C=(s.arrow?.y??0)+c/2;let w="",f="";return d==="bottom"?(w=o?x:`${b}px`,f=`${-c}px`):d==="top"?(w=o?x:`${b}px`,f=`${r.floating.height+c}px`):d==="right"?(w=`${-c}px`,f=o?x:`${C}px`):d==="left"&&(w=`${r.floating.width+c}px`,f=o?x:`${C}px`),{data:{x:w,y:f}}}});function es(e){const[t,n="center"]=e.split("-");return[t,n]}var Rl=Ga,kl=Ka,Il=Xa,Pl=Ja,Ol="Portal",ts=m.forwardRef((e,t)=>{const{container:n,...r}=e,[s,i]=m.useState(!1);ge(()=>i(!0),[]);const o=n||s&&globalThis?.document?.body;return o?oi.createPortal(a.jsx(se.div,{...r,ref:t}),o):null});ts.displayName=Ol;var Dl=wa[" useInsertionEffect ".trim().toString()]||ge;function Gr({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,o]=zl({defaultProp:t,onChange:n}),l=e!==void 0,c=l?e:s;{const u=m.useRef(e!==void 0);m.useEffect(()=>{const x=u.current;x!==l&&console.warn(`${r} is changing from ${x?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,r])}const d=m.useCallback(u=>{if(l){const x=Ml(u)?u(e):u;x!==e&&o.current?.(x)}else i(u)},[l,e,i,o]);return[c,d]}function zl({defaultProp:e,onChange:t}){const[n,r]=m.useState(e),s=m.useRef(n),i=m.useRef(t);return Dl(()=>{i.current=t},[t]),m.useEffect(()=>{s.current!==n&&(i.current?.(n),s.current=n)},[n,s]),[n,r,i]}function Ml(e){return typeof e=="function"}function Ll(e){const t=m.useRef({value:e,previous:e});return m.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ns=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Bl="VisuallyHidden",$l=m.forwardRef((e,t)=>a.jsx(se.span,{...e,ref:t,style:{...ns,...e.style}}));$l.displayName=Bl;var Fl=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ht=new WeakMap,Zt=new WeakMap,Ut={},Pn=0,rs=function(e){return e&&(e.host||rs(e.parentNode))},Vl=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=rs(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},ql=function(e,t,n,r){var s=Vl(t,Array.isArray(e)?e:[e]);Ut[n]||(Ut[n]=new WeakMap);var i=Ut[n],o=[],l=new Set,c=new Set(s),d=function(x){!x||l.has(x)||(l.add(x),d(x.parentNode))};s.forEach(d);var u=function(x){!x||c.has(x)||Array.prototype.forEach.call(x.children,function(b){if(l.has(b))u(b);else try{var C=b.getAttribute(r),w=C!==null&&C!=="false",f=(ht.get(b)||0)+1,v=(i.get(b)||0)+1;ht.set(b,f),i.set(b,v),o.push(b),f===1&&w&&Zt.set(b,!0),v===1&&b.setAttribute(n,"true"),w||b.setAttribute(r,"true")}catch(h){console.error("aria-hidden: cannot operate on ",b,h)}})};return u(t),l.clear(),Pn++,function(){o.forEach(function(x){var b=ht.get(x)-1,C=i.get(x)-1;ht.set(x,b),i.set(x,C),b||(Zt.has(x)||x.removeAttribute(r),Zt.delete(x)),C||x.removeAttribute(n)}),Pn--,Pn||(ht=new WeakMap,ht=new WeakMap,Zt=new WeakMap,Ut={})}},Hl=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=Fl(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),ql(r,s,n,"aria-hidden")):function(){return null}},Pe=function(){return Pe=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Pe.apply(this,arguments)};function as(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function Zl(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Qt="right-scroll-bar-position",Jt="width-before-scroll-bar",Ul="with-scroll-bars-hidden",Wl="--removed-body-scroll-bar-size";function On(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Gl(e,t){var n=m.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var Yl=typeof window<"u"?m.useLayoutEffect:m.useEffect,Yr=new WeakMap;function Kl(e,t){var n=Gl(null,function(r){return e.forEach(function(s){return On(s,r)})});return Yl(function(){var r=Yr.get(n);if(r){var s=new Set(r),i=new Set(e),o=n.current;s.forEach(function(l){i.has(l)||On(l,null)}),i.forEach(function(l){s.has(l)||On(l,o)})}Yr.set(n,e)},[e]),n}function Xl(e){return e}function Ql(e,t){t===void 0&&(t=Xl);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var o=t(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var u=o;o=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),n={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),n}}}};return s}function Jl(e){e===void 0&&(e={});var t=Ql(null);return t.options=Pe({async:!0,ssr:!1},e),t}var ss=function(e){var t=e.sideCar,n=as(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return m.createElement(r,Pe({},n))};ss.isSideCarExport=!0;function ec(e,t){return e.useMedium(t),ss}var is=Jl(),Dn=function(){},yn=m.forwardRef(function(e,t){var n=m.useRef(null),r=m.useState({onScrollCapture:Dn,onWheelCapture:Dn,onTouchMoveCapture:Dn}),s=r[0],i=r[1],o=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,x=e.shards,b=e.sideCar,C=e.noRelative,w=e.noIsolation,f=e.inert,v=e.allowPinchZoom,h=e.as,j=h===void 0?"div":h,A=e.gapMode,y=as(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=b,S=Kl([n,t]),_=Pe(Pe({},y),s);return m.createElement(m.Fragment,null,u&&m.createElement(T,{sideCar:is,removeScrollBar:d,shards:x,noRelative:C,noIsolation:w,inert:f,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:A}),o?m.cloneElement(m.Children.only(l),Pe(Pe({},_),{ref:S})):m.createElement(j,Pe({},_,{className:c,ref:S}),l))});yn.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};yn.classNames={fullWidth:Jt,zeroRight:Qt};var tc=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function nc(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=tc();return t&&e.setAttribute("nonce",t),e}function rc(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function ac(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var sc=function(){var e=0,t=null;return{add:function(n){e==0&&(t=nc())&&(rc(t,n),ac(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ic=function(){var e=sc();return function(t,n){m.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},os=function(){var e=ic(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},oc={left:0,top:0,right:0,gap:0},zn=function(e){return parseInt(e||"",10)||0},lc=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[zn(n),zn(r),zn(s)]},cc=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return oc;var t=lc(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},dc=os(),yt="data-scroll-locked",uc=function(e,t,n,r){var s=e.left,i=e.top,o=e.right,l=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ul,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(yt,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qt,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Jt,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Qt," .").concat(Qt,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Jt," .").concat(Jt,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(yt,`] {
    `).concat(Wl,": ").concat(l,`px;
  }
`)},Kr=function(){var e=parseInt(document.body.getAttribute(yt)||"0",10);return isFinite(e)?e:0},mc=function(){m.useEffect(function(){return document.body.setAttribute(yt,(Kr()+1).toString()),function(){var e=Kr()-1;e<=0?document.body.removeAttribute(yt):document.body.setAttribute(yt,e.toString())}},[])},fc=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;mc();var i=m.useMemo(function(){return cc(s)},[s]);return m.createElement(dc,{styles:uc(i,!t,s,n?"":"!important")})},Wn=!1;if(typeof window<"u")try{var Wt=Object.defineProperty({},"passive",{get:function(){return Wn=!0,!0}});window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch{Wn=!1}var gt=Wn?{passive:!1}:!1,pc=function(e){return e.tagName==="TEXTAREA"},ls=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!pc(e)&&n[t]==="visible")},hc=function(e){return ls(e,"overflowY")},gc=function(e){return ls(e,"overflowX")},Xr=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=cs(e,r);if(s){var i=ds(e,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},xc=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},vc=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},cs=function(e,t){return e==="v"?hc(t):gc(t)},ds=function(e,t){return e==="v"?xc(t):vc(t)},bc=function(e,t){return e==="h"&&t==="rtl"?-1:1},yc=function(e,t,n,r,s){var i=bc(e,window.getComputedStyle(t).direction),o=i*r,l=n.target,c=t.contains(l),d=!1,u=o>0,x=0,b=0;do{if(!l)break;var C=ds(e,l),w=C[0],f=C[1],v=C[2],h=f-v-i*w;(w||h)&&cs(e,l)&&(x+=h,b+=w);var j=l.parentNode;l=j&&j.nodeType===Node.DOCUMENT_FRAGMENT_NODE?j.host:j}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&Math.abs(x)<1||!u&&Math.abs(b)<1)&&(d=!0),d},Gt=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Qr=function(e){return[e.deltaX,e.deltaY]},Jr=function(e){return e&&"current"in e?e.current:e},wc=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Cc=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},jc=0,xt=[];function Nc(e){var t=m.useRef([]),n=m.useRef([0,0]),r=m.useRef(),s=m.useState(jc++)[0],i=m.useState(os)[0],o=m.useRef(e);m.useEffect(function(){o.current=e},[e]),m.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var f=Zl([e.lockRef.current],(e.shards||[]).map(Jr),!0).filter(Boolean);return f.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),f.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=m.useCallback(function(f,v){if("touches"in f&&f.touches.length===2||f.type==="wheel"&&f.ctrlKey)return!o.current.allowPinchZoom;var h=Gt(f),j=n.current,A="deltaX"in f?f.deltaX:j[0]-h[0],y="deltaY"in f?f.deltaY:j[1]-h[1],T,S=f.target,_=Math.abs(A)>Math.abs(y)?"h":"v";if("touches"in f&&_==="h"&&S.type==="range")return!1;var N=Xr(_,S);if(!N)return!0;if(N?T=_:(T=_==="v"?"h":"v",N=Xr(_,S)),!N)return!1;if(!r.current&&"changedTouches"in f&&(A||y)&&(r.current=T),!T)return!0;var P=r.current||T;return yc(P,v,f,P==="h"?A:y)},[]),c=m.useCallback(function(f){var v=f;if(!(!xt.length||xt[xt.length-1]!==i)){var h="deltaY"in v?Qr(v):Gt(v),j=t.current.filter(function(T){return T.name===v.type&&(T.target===v.target||v.target===T.shadowParent)&&wc(T.delta,h)})[0];if(j&&j.should){v.cancelable&&v.preventDefault();return}if(!j){var A=(o.current.shards||[]).map(Jr).filter(Boolean).filter(function(T){return T.contains(v.target)}),y=A.length>0?l(v,A[0]):!o.current.noIsolation;y&&v.cancelable&&v.preventDefault()}}},[]),d=m.useCallback(function(f,v,h,j){var A={name:f,delta:v,target:h,should:j,shadowParent:Sc(h)};t.current.push(A),setTimeout(function(){t.current=t.current.filter(function(y){return y!==A})},1)},[]),u=m.useCallback(function(f){n.current=Gt(f),r.current=void 0},[]),x=m.useCallback(function(f){d(f.type,Qr(f),f.target,l(f,e.lockRef.current))},[]),b=m.useCallback(function(f){d(f.type,Gt(f),f.target,l(f,e.lockRef.current))},[]);m.useEffect(function(){return xt.push(i),e.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",c,gt),document.addEventListener("touchmove",c,gt),document.addEventListener("touchstart",u,gt),function(){xt=xt.filter(function(f){return f!==i}),document.removeEventListener("wheel",c,gt),document.removeEventListener("touchmove",c,gt),document.removeEventListener("touchstart",u,gt)}},[]);var C=e.removeScrollBar,w=e.inert;return m.createElement(m.Fragment,null,w?m.createElement(i,{styles:Cc(s)}):null,C?m.createElement(fc,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Sc(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const _c=ec(is,Nc);var us=m.forwardRef(function(e,t){return m.createElement(yn,Pe({},e,{ref:t,sideCar:_c}))});us.classNames=yn.classNames;var Ac=[" ","Enter","ArrowUp","ArrowDown"],Tc=[" ","Enter"],ut="Select",[wn,Cn,Ec]=Fi(ut),[kt]=fr(ut,[Ec,Ua]),jn=Ua(),[Rc,rt]=kt(ut),[kc,Ic]=kt(ut),ms=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:x,disabled:b,required:C,form:w}=e,f=jn(t),[v,h]=m.useState(null),[j,A]=m.useState(null),[y,T]=m.useState(!1),S=qi(d),[_,N]=Gr({prop:r,defaultProp:s??!1,onChange:i,caller:ut}),[P,L]=Gr({prop:o,defaultProp:l,onChange:c,caller:ut}),$=m.useRef(null),F=v?w||!!v.closest("form"):!0,[E,p]=m.useState(new Set),g=Array.from(E).map(R=>R.props.value).join(";");return a.jsx(Rl,{...f,children:a.jsxs(Rc,{required:C,scope:t,trigger:v,onTriggerChange:h,valueNode:j,onValueNodeChange:A,valueNodeHasChildren:y,onValueNodeHasChildrenChange:T,contentId:pr(),value:P,onValueChange:L,open:_,onOpenChange:N,dir:S,triggerPointerDownPosRef:$,disabled:b,children:[a.jsx(wn.Provider,{scope:t,children:a.jsx(kc,{scope:e.__scopeSelect,onNativeOptionAdd:m.useCallback(R=>{p(O=>new Set(O).add(R))},[]),onNativeOptionRemove:m.useCallback(R=>{p(O=>{const I=new Set(O);return I.delete(R),I})},[]),children:n})}),F?a.jsxs(zs,{"aria-hidden":!0,required:C,tabIndex:-1,name:u,autoComplete:x,value:P,onChange:R=>L(R.target.value),disabled:b,form:w,children:[P===void 0?a.jsx("option",{value:""}):null,Array.from(E)]},g):null]})})};ms.displayName=ut;var fs="SelectTrigger",ps=m.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=jn(n),o=rt(fs,n),l=o.disabled||r,c=me(t,o.onTriggerChange),d=Cn(n),u=m.useRef("touch"),[x,b,C]=Ls(f=>{const v=d().filter(A=>!A.disabled),h=v.find(A=>A.value===o.value),j=Bs(v,f,h);j!==void 0&&o.onValueChange(j.value)}),w=f=>{l||(o.onOpenChange(!0),C()),f&&(o.triggerPointerDownPosRef.current={x:Math.round(f.pageX),y:Math.round(f.pageY)})};return a.jsx(kl,{asChild:!0,...i,children:a.jsx(se.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Ms(o.value)?"":void 0,...s,ref:c,onClick:de(s.onClick,f=>{f.currentTarget.focus(),u.current!=="mouse"&&w(f)}),onPointerDown:de(s.onPointerDown,f=>{u.current=f.pointerType;const v=f.target;v.hasPointerCapture(f.pointerId)&&v.releasePointerCapture(f.pointerId),f.button===0&&f.ctrlKey===!1&&f.pointerType==="mouse"&&(w(f),f.preventDefault())}),onKeyDown:de(s.onKeyDown,f=>{const v=x.current!=="";!(f.ctrlKey||f.altKey||f.metaKey)&&f.key.length===1&&b(f.key),!(v&&f.key===" ")&&Ac.includes(f.key)&&(w(),f.preventDefault())})})})});ps.displayName=fs;var hs="SelectValue",gs=m.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o="",...l}=e,c=rt(hs,n),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,x=me(t,c.onValueNodeChange);return ge(()=>{d(u)},[d,u]),a.jsx(se.span,{...l,ref:x,style:{pointerEvents:"none"},children:Ms(c.value)?a.jsx(a.Fragment,{children:o}):i})});gs.displayName=hs;var Pc="SelectIcon",xs=m.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return a.jsx(se.span,{"aria-hidden":!0,...s,ref:t,children:r||"▼"})});xs.displayName=Pc;var Oc="SelectPortal",vs=e=>a.jsx(ts,{asChild:!0,...e});vs.displayName=Oc;var mt="SelectContent",bs=m.forwardRef((e,t)=>{const n=rt(mt,e.__scopeSelect),[r,s]=m.useState();if(ge(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?hn.createPortal(a.jsx(ys,{scope:e.__scopeSelect,children:a.jsx(wn.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),i):null}return a.jsx(ws,{...e,ref:t})});bs.displayName=mt;var Ae=10,[ys,at]=kt(mt),Dc="SelectContentImpl",zc=tn("SelectContent.RemoveScroll"),ws=m.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:x,collisionBoundary:b,collisionPadding:C,sticky:w,hideWhenDetached:f,avoidCollisions:v,...h}=e,j=rt(mt,n),[A,y]=m.useState(null),[T,S]=m.useState(null),_=me(t,V=>y(V)),[N,P]=m.useState(null),[L,$]=m.useState(null),F=Cn(n),[E,p]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(A)return Hl(A)},[A]),eo();const R=m.useCallback(V=>{const[ee,...pe]=F().map(oe=>oe.ref.current),[X]=pe.slice(-1),te=document.activeElement;for(const oe of V)if(oe===te||(oe?.scrollIntoView({block:"nearest"}),oe===ee&&T&&(T.scrollTop=0),oe===X&&T&&(T.scrollTop=T.scrollHeight),oe?.focus(),document.activeElement!==te))return},[F,T]),O=m.useCallback(()=>R([N,A]),[R,N,A]);m.useEffect(()=>{E&&O()},[E,O]);const{onOpenChange:I,triggerPointerDownPosRef:z}=j;m.useEffect(()=>{if(A){let V={x:0,y:0};const ee=X=>{V={x:Math.abs(Math.round(X.pageX)-(z.current?.x??0)),y:Math.abs(Math.round(X.pageY)-(z.current?.y??0))}},pe=X=>{V.x<=10&&V.y<=10?X.preventDefault():A.contains(X.target)||I(!1),document.removeEventListener("pointermove",ee),z.current=null};return z.current!==null&&(document.addEventListener("pointermove",ee),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ee),document.removeEventListener("pointerup",pe,{capture:!0})}}},[A,I,z]),m.useEffect(()=>{const V=()=>I(!1);return window.addEventListener("blur",V),window.addEventListener("resize",V),()=>{window.removeEventListener("blur",V),window.removeEventListener("resize",V)}},[I]);const[Z,Q]=Ls(V=>{const ee=F().filter(te=>!te.disabled),pe=ee.find(te=>te.ref.current===document.activeElement),X=Bs(ee,V,pe);X&&setTimeout(()=>X.ref.current.focus())}),ne=m.useCallback((V,ee,pe)=>{const X=!g.current&&!pe;(j.value!==void 0&&j.value===ee||X)&&(P(V),X&&(g.current=!0))},[j.value]),J=m.useCallback(()=>A?.focus(),[A]),ue=m.useCallback((V,ee,pe)=>{const X=!g.current&&!pe;(j.value!==void 0&&j.value===ee||X)&&$(V)},[j.value]),ie=r==="popper"?Gn:Cs,fe=ie===Gn?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:x,collisionBoundary:b,collisionPadding:C,sticky:w,hideWhenDetached:f,avoidCollisions:v}:{};return a.jsx(ys,{scope:n,content:A,viewport:T,onViewportChange:S,itemRefCallback:ne,selectedItem:N,onItemLeave:J,itemTextRefCallback:ue,focusSelectedItem:O,selectedItemText:L,position:r,isPositioned:E,searchRef:Z,children:a.jsx(us,{as:zc,allowPinchZoom:!0,children:a.jsx(ka,{asChild:!0,trapped:j.open,onMountAutoFocus:V=>{V.preventDefault()},onUnmountAutoFocus:de(s,V=>{j.trigger?.focus({preventScroll:!0}),V.preventDefault()}),children:a.jsx(Ea,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:V=>V.preventDefault(),onDismiss:()=>j.onOpenChange(!1),children:a.jsx(ie,{role:"listbox",id:j.contentId,"data-state":j.open?"open":"closed",dir:j.dir,onContextMenu:V=>V.preventDefault(),...h,...fe,onPlaced:()=>p(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...h.style},onKeyDown:de(h.onKeyDown,V=>{const ee=V.ctrlKey||V.altKey||V.metaKey;if(V.key==="Tab"&&V.preventDefault(),!ee&&V.key.length===1&&Q(V.key),["ArrowUp","ArrowDown","Home","End"].includes(V.key)){let X=F().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(V.key)&&(X=X.slice().reverse()),["ArrowUp","ArrowDown"].includes(V.key)){const te=V.target,oe=X.indexOf(te);X=X.slice(oe+1)}setTimeout(()=>R(X)),V.preventDefault()}})})})})})})});ws.displayName=Dc;var Mc="SelectItemAlignedPosition",Cs=m.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=rt(mt,n),o=at(mt,n),[l,c]=m.useState(null),[d,u]=m.useState(null),x=me(t,_=>u(_)),b=Cn(n),C=m.useRef(!1),w=m.useRef(!0),{viewport:f,selectedItem:v,selectedItemText:h,focusSelectedItem:j}=o,A=m.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&f&&v&&h){const _=i.trigger.getBoundingClientRect(),N=d.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),L=h.getBoundingClientRect();if(i.dir!=="rtl"){const te=L.left-N.left,oe=P.left-te,Ce=_.left-oe,st=_.width+Ce,Nn=Math.max(st,N.width),Sn=window.innerWidth-Ae,_n=Tr(oe,[Ae,Math.max(Ae,Sn-Nn)]);l.style.minWidth=st+"px",l.style.left=_n+"px"}else{const te=N.right-L.right,oe=window.innerWidth-P.right-te,Ce=window.innerWidth-_.right-oe,st=_.width+Ce,Nn=Math.max(st,N.width),Sn=window.innerWidth-Ae,_n=Tr(oe,[Ae,Math.max(Ae,Sn-Nn)]);l.style.minWidth=st+"px",l.style.right=_n+"px"}const $=b(),F=window.innerHeight-Ae*2,E=f.scrollHeight,p=window.getComputedStyle(d),g=parseInt(p.borderTopWidth,10),R=parseInt(p.paddingTop,10),O=parseInt(p.borderBottomWidth,10),I=parseInt(p.paddingBottom,10),z=g+R+E+I+O,Z=Math.min(v.offsetHeight*5,z),Q=window.getComputedStyle(f),ne=parseInt(Q.paddingTop,10),J=parseInt(Q.paddingBottom,10),ue=_.top+_.height/2-Ae,ie=F-ue,fe=v.offsetHeight/2,V=v.offsetTop+fe,ee=g+R+V,pe=z-ee;if(ee<=ue){const te=$.length>0&&v===$[$.length-1].ref.current;l.style.bottom="0px";const oe=d.clientHeight-f.offsetTop-f.offsetHeight,Ce=Math.max(ie,fe+(te?J:0)+oe+O),st=ee+Ce;l.style.height=st+"px"}else{const te=$.length>0&&v===$[0].ref.current;l.style.top="0px";const Ce=Math.max(ue,g+f.offsetTop+(te?ne:0)+fe)+pe;l.style.height=Ce+"px",f.scrollTop=ee-ue+f.offsetTop}l.style.margin=`${Ae}px 0`,l.style.minHeight=Z+"px",l.style.maxHeight=F+"px",r?.(),requestAnimationFrame(()=>C.current=!0)}},[b,i.trigger,i.valueNode,l,d,f,v,h,i.dir,r]);ge(()=>A(),[A]);const[y,T]=m.useState();ge(()=>{d&&T(window.getComputedStyle(d).zIndex)},[d]);const S=m.useCallback(_=>{_&&w.current===!0&&(A(),j?.(),w.current=!1)},[A,j]);return a.jsx(Bc,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:C,onScrollButtonChange:S,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:y},children:a.jsx(se.div,{...s,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Cs.displayName=Mc;var Lc="SelectPopperPosition",Gn=m.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Ae,...i}=e,o=jn(n);return a.jsx(Il,{...o,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Gn.displayName=Lc;var[Bc,jr]=kt(mt,{}),Yn="SelectViewport",js=m.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=at(Yn,n),o=jr(Yn,n),l=me(t,i.onViewportChange),c=m.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),a.jsx(wn.Slot,{scope:n,children:a.jsx(se.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:de(s.onScroll,d=>{const u=d.currentTarget,{contentWrapper:x,shouldExpandOnScrollRef:b}=o;if(b?.current&&x){const C=Math.abs(c.current-u.scrollTop);if(C>0){const w=window.innerHeight-Ae*2,f=parseFloat(x.style.minHeight),v=parseFloat(x.style.height),h=Math.max(f,v);if(h<w){const j=h+C,A=Math.min(w,j),y=j-A;x.style.height=A+"px",x.style.bottom==="0px"&&(u.scrollTop=y>0?y:0,x.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});js.displayName=Yn;var Ns="SelectGroup",[$c,Fc]=kt(Ns),Vc=m.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=pr();return a.jsx($c,{scope:n,id:s,children:a.jsx(se.div,{role:"group","aria-labelledby":s,...r,ref:t})})});Vc.displayName=Ns;var Ss="SelectLabel",_s=m.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Fc(Ss,n);return a.jsx(se.div,{id:s.id,...r,ref:t})});_s.displayName=Ss;var on="SelectItem",[qc,As]=kt(on),Ts=m.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=e,l=rt(on,n),c=at(on,n),d=l.value===r,[u,x]=m.useState(i??""),[b,C]=m.useState(!1),w=me(t,j=>c.itemRefCallback?.(j,r,s)),f=pr(),v=m.useRef("touch"),h=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(qc,{scope:n,value:r,disabled:s,textId:f,isSelected:d,onItemTextChange:m.useCallback(j=>{x(A=>A||(j?.textContent??"").trim())},[]),children:a.jsx(wn.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:a.jsx(se.div,{role:"option","aria-labelledby":f,"data-highlighted":b?"":void 0,"aria-selected":d&&b,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:w,onFocus:de(o.onFocus,()=>C(!0)),onBlur:de(o.onBlur,()=>C(!1)),onClick:de(o.onClick,()=>{v.current!=="mouse"&&h()}),onPointerUp:de(o.onPointerUp,()=>{v.current==="mouse"&&h()}),onPointerDown:de(o.onPointerDown,j=>{v.current=j.pointerType}),onPointerMove:de(o.onPointerMove,j=>{v.current=j.pointerType,s?c.onItemLeave?.():v.current==="mouse"&&j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:de(o.onPointerLeave,j=>{j.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:de(o.onKeyDown,j=>{c.searchRef?.current!==""&&j.key===" "||(Tc.includes(j.key)&&h(),j.key===" "&&j.preventDefault())})})})})});Ts.displayName=on;var Ot="SelectItemText",Es=m.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,o=rt(Ot,n),l=at(Ot,n),c=As(Ot,n),d=Ic(Ot,n),[u,x]=m.useState(null),b=me(t,h=>x(h),c.onItemTextChange,h=>l.itemTextRefCallback?.(h,c.value,c.disabled)),C=u?.textContent,w=m.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:C},c.value),[c.disabled,c.value,C]),{onNativeOptionAdd:f,onNativeOptionRemove:v}=d;return ge(()=>(f(w),()=>v(w)),[f,v,w]),a.jsxs(a.Fragment,{children:[a.jsx(se.span,{id:c.textId,...i,ref:b}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?hn.createPortal(i.children,o.valueNode):null]})});Es.displayName=Ot;var Rs="SelectItemIndicator",ks=m.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return As(Rs,n).isSelected?a.jsx(se.span,{"aria-hidden":!0,...r,ref:t}):null});ks.displayName=Rs;var Kn="SelectScrollUpButton",Is=m.forwardRef((e,t)=>{const n=at(Kn,e.__scopeSelect),r=jr(Kn,e.__scopeSelect),[s,i]=m.useState(!1),o=me(t,r.onScrollButtonChange);return ge(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(Os,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});Is.displayName=Kn;var Xn="SelectScrollDownButton",Ps=m.forwardRef((e,t)=>{const n=at(Xn,e.__scopeSelect),r=jr(Xn,e.__scopeSelect),[s,i]=m.useState(!1),o=me(t,r.onScrollButtonChange);return ge(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(Os,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});Ps.displayName=Xn;var Os=m.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=at("SelectScrollButton",n),o=m.useRef(null),l=Cn(n),c=m.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return m.useEffect(()=>()=>c(),[c]),ge(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),a.jsx(se.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:de(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:de(s.onPointerMove,()=>{i.onItemLeave?.(),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:de(s.onPointerLeave,()=>{c()})})}),Hc="SelectSeparator",Ds=m.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return a.jsx(se.div,{"aria-hidden":!0,...r,ref:t})});Ds.displayName=Hc;var Qn="SelectArrow",Zc=m.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=jn(n),i=rt(Qn,n),o=at(Qn,n);return i.open&&o.position==="popper"?a.jsx(Pl,{...s,...r,ref:t}):null});Zc.displayName=Qn;var Uc="SelectBubbleInput",zs=m.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=m.useRef(null),i=me(r,s),o=Ll(t);return m.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&u){const x=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(x)}},[o,t]),a.jsx(se.select,{...n,style:{...ns,...n.style},ref:i,defaultValue:t})});zs.displayName=Uc;function Ms(e){return e===""||e===void 0}function Ls(e){const t=ct(e),n=m.useRef(""),r=m.useRef(0),s=m.useCallback(o=>{const l=n.current+o;t(l),function c(d){n.current=d,window.clearTimeout(r.current),d!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=m.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function Bs(e,t,n){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let o=Wc(e,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function Wc(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Gc=ms,$s=ps,Yc=gs,Kc=xs,Xc=vs,Fs=bs,Qc=js,Vs=_s,qs=Ts,Jc=Es,ed=ks,Hs=Is,Zs=Ps,Us=Ds;const Ee=Gc,Re=Yc,je=m.forwardRef(({className:e,children:t,...n},r)=>a.jsxs($s,{ref:r,className:Se("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:[t,a.jsx(Kc,{asChild:!0,children:a.jsx(ja,{className:"h-4 w-4 opacity-50"})})]}));je.displayName=$s.displayName;const Ws=m.forwardRef(({className:e,...t},n)=>a.jsx(Hs,{ref:n,className:Se("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(ui,{className:"h-4 w-4"})}));Ws.displayName=Hs.displayName;const Gs=m.forwardRef(({className:e,...t},n)=>a.jsx(Zs,{ref:n,className:Se("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(ja,{className:"h-4 w-4"})}));Gs.displayName=Zs.displayName;const Ne=m.forwardRef(({className:e,children:t,position:n="popper",...r},s)=>a.jsx(Xc,{children:a.jsxs(Fs,{ref:s,className:Se("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[a.jsx(Ws,{}),a.jsx(Qc,{className:Se("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(Gs,{})]})}));Ne.displayName=Fs.displayName;const td=m.forwardRef(({className:e,...t},n)=>a.jsx(Vs,{ref:n,className:Se("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));td.displayName=Vs.displayName;const Ys=m.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(qs,{ref:r,className:Se("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(ed,{children:a.jsx(mi,{className:"h-4 w-4"})})}),a.jsx(Jc,{children:t})]}));Ys.displayName=qs.displayName;const nd=m.forwardRef(({className:e,...t},n)=>a.jsx(Us,{ref:n,className:Se("-mx-1 my-1 h-px bg-muted",e),...t}));nd.displayName=Us.displayName;const ae=({children:e,...t})=>a.jsx(Ys,{...t,value:t.value,children:e}),qt=xe.forwardRef(({className:e,...t},n)=>a.jsx("textarea",{className:Se("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));qt.displayName="Textarea";var rd=/\s+/g,Jn=e=>typeof e!="string"||!e?e:e.replace(rd," ").trim(),ln=(...e)=>{let t=[],n=r=>{if(!r&&r!==0&&r!==0n)return;if(Array.isArray(r)){for(let i=0,o=r.length;i<o;i++)n(r[i]);return}let s=typeof r;if(s==="string"||s==="number"||s==="bigint"){if(s==="number"&&r!==r)return;t.push(String(r))}else if(s==="object"){let i=Object.keys(r);for(let o=0,l=i.length;o<l;o++){let c=i[o];r[c]&&t.push(c)}}};for(let r=0,s=e.length;r<s;r++){let i=e[r];i!=null&&n(i)}return t.length>0?Jn(t.join(" ")):void 0},ea=e=>e===!1?"false":e===!0?"true":e===0?"0":e,he=e=>{if(!e||typeof e!="object")return!0;for(let t in e)return!1;return!0},ad=(e,t)=>{if(e===t)return!0;if(!e||!t)return!1;let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++){let i=n[s];if(!r.includes(i)||e[i]!==t[i])return!1}return!0},ta=(e,t)=>{for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n];n in e?e[n]=ln(e[n],r):e[n]=r}return e},Ks=(e,t)=>{for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?Ks(r,t):r&&t.push(r)}},Xs=(...e)=>{let t=[];Ks(e,t);let n=[];for(let r=0;r<t.length;r++)t[r]&&n.push(t[r]);return n},er=(e,t)=>{let n={};for(let r in e){let s=e[r];if(r in t){let i=t[r];Array.isArray(s)||Array.isArray(i)?n[r]=Xs(i,s):typeof s=="object"&&typeof i=="object"&&s&&i?n[r]=er(s,i):n[r]=i+" "+s}else n[r]=s}for(let r in t)r in e||(n[r]=t[r]);return n},sd={twMerge:!0,twMergeConfig:{},responsiveVariants:!1};function id(){let e=null,t={},n=!1;return{get cachedTwMerge(){return e},set cachedTwMerge(r){e=r},get cachedTwMergeConfig(){return t},set cachedTwMergeConfig(r){t=r},get didTwMergeConfigChange(){return n},set didTwMergeConfigChange(r){n=r},reset(){e=null,t={},n=!1}}}var Fe=id(),od=e=>{let t=(n,r)=>{let{extend:s=null,slots:i={},variants:o={},compoundVariants:l=[],compoundSlots:c=[],defaultVariants:d={}}=n,u={...sd,...r},x=s?.base?ln(s.base,n?.base):n?.base,b=s?.variants&&!he(s.variants)?er(o,s.variants):o,C=s?.defaultVariants&&!he(s.defaultVariants)?{...s.defaultVariants,...d}:d;!he(u.twMergeConfig)&&!ad(u.twMergeConfig,Fe.cachedTwMergeConfig)&&(Fe.didTwMergeConfigChange=!0,Fe.cachedTwMergeConfig=u.twMergeConfig);let w=he(s?.slots),f=he(i)?{}:{base:ln(n?.base,w&&s?.base),...i},v=w?f:ta({...s?.slots},he(f)?{base:n?.base}:f),h=he(s?.compoundVariants)?l:Xs(s?.compoundVariants,l),j=y=>{if(he(b)&&he(i)&&w)return e(x,y?.class,y?.className)(u);if(h&&!Array.isArray(h))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof h}`);if(c&&!Array.isArray(c))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof c}`);let T=(p,g,R=[],O)=>{let I=R;if(typeof g=="string"){let z=Jn(g).split(" ");for(let Z=0;Z<z.length;Z++)I.push(`${p}:${z[Z]}`)}else if(Array.isArray(g))for(let z=0;z<g.length;z++)I.push(`${p}:${g[z]}`);else if(typeof g=="object"&&typeof O=="string"&&O in g){let z=g[O];if(z&&typeof z=="string"){let Z=Jn(z).split(" "),Q=[];for(let ne=0;ne<Z.length;ne++)Q.push(`${p}:${Z[ne]}`);I[O]=I[O]?I[O].concat(Q):Q}else if(Array.isArray(z)&&z.length>0){let Z=[];for(let Q=0;Q<z.length;Q++)Z.push(`${p}:${z[Q]}`);I[O]=Z}}return I},S=(p,g=b,R=null,O=null)=>{let I=g[p];if(!I||he(I))return null;let z=O?.[p]??y?.[p];if(z===null)return null;let Z=ea(z),Q=Array.isArray(u.responsiveVariants)&&u.responsiveVariants.length>0||u.responsiveVariants===!0,ne=C?.[p],J=[];if(typeof Z=="object"&&Q)for(let[fe,V]of Object.entries(Z)){let ee=I[V];if(fe==="initial"){ne=V;continue}Array.isArray(u.responsiveVariants)&&!u.responsiveVariants.includes(fe)||(J=T(fe,ee,J,R))}let ue=Z!=null&&typeof Z!="object"?Z:ea(ne),ie=I[ue||"false"];return typeof J=="object"&&typeof R=="string"&&J[R]?ta(J,ie):J.length>0?(J.push(ie),R==="base"?J.join(" "):J):ie},_=()=>{if(!b)return null;let p=Object.keys(b),g=[];for(let R=0;R<p.length;R++){let O=S(p[R],b);O&&g.push(O)}return g},N=(p,g)=>{if(!b||typeof b!="object")return null;let R=[];for(let O in b){let I=S(O,b,p,g),z=p==="base"&&typeof I=="string"?I:I&&I[p];z&&R.push(z)}return R},P={};for(let p in y){let g=y[p];g!==void 0&&(P[p]=g)}let L=(p,g)=>{let R=typeof y?.[p]=="object"?{[p]:y[p]?.initial}:{};return{...C,...P,...R,...g}},$=(p=[],g)=>{let R=[],O=p.length;for(let I=0;I<O;I++){let{class:z,className:Z,...Q}=p[I],ne=!0,J=L(null,g);for(let ue in Q){let ie=Q[ue],fe=J[ue];if(Array.isArray(ie)){if(!ie.includes(fe)){ne=!1;break}}else{if((ie==null||ie===!1)&&(fe==null||fe===!1))continue;if(fe!==ie){ne=!1;break}}}ne&&(z&&R.push(z),Z&&R.push(Z))}return R},F=p=>{let g=$(h,p);if(!Array.isArray(g))return g;let R={},O=e;for(let I=0;I<g.length;I++){let z=g[I];if(typeof z=="string")R.base=O(R.base,z)(u);else if(typeof z=="object")for(let Z in z)R[Z]=O(R[Z],z[Z])(u)}return R},E=p=>{if(c.length<1)return null;let g={},R=L(null,p);for(let O=0;O<c.length;O++){let{slots:I=[],class:z,className:Z,...Q}=c[O];if(!he(Q)){let ne=!0;for(let J in Q){let ue=R[J],ie=Q[J];if(ue===void 0||(Array.isArray(ie)?!ie.includes(ue):ie!==ue)){ne=!1;break}}if(!ne)continue}for(let ne=0;ne<I.length;ne++){let J=I[ne];g[J]||(g[J]=[]),g[J].push([z,Z])}}return g};if(!he(i)||!w){let p={};if(typeof v=="object"&&!he(v)){let g=e;for(let R in v)p[R]=O=>{let I=F(O),z=E(O);return g(v[R],N(R,O),I?I[R]:void 0,z?z[R]:void 0,O?.class,O?.className)(u)}}return p}return e(x,_(),$(h),y?.class,y?.className)(u)},A=()=>{if(!(!b||typeof b!="object"))return Object.keys(b)};return j.variantKeys=A(),j.extend=s,j.base=x,j.slots=v,j.variants=b,j.defaultVariants=C,j.compoundSlots=c,j.compoundVariants=h,j};return{tv:t,createTV:n=>(r,s)=>t(r,s?er(n,s):n)}},ld=e=>he(e)?bi:yi({...e,extend:{theme:e.theme,classGroups:e.classGroups,conflictingClassGroupModifiers:e.conflictingClassGroupModifiers,conflictingClassGroups:e.conflictingClassGroups,...e.extend}}),cd=(...e)=>t=>{let n=ln(e);return!n||!t.twMerge?n:((!Fe.cachedTwMerge||Fe.didTwMergeConfigChange)&&(Fe.didTwMergeConfigChange=!1,Fe.cachedTwMerge=ld(Fe.cachedTwMergeConfig)),Fe.cachedTwMerge(n)||void 0)},{tv:dd}=od(cd);const ud=dd({base:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border-input bg-transparent text-foreground hover:bg-accent hover:text-accent-foreground",muted:"border-transparent bg-muted text-muted-foreground"},tone:{neutral:"",success:"border-green-200 bg-green-100 text-green-700",warning:"border-amber-200 bg-amber-100 text-amber-800",danger:"border-red-200 bg-red-100 text-red-800",info:"border-blue-200 bg-blue-100 text-blue-700"},size:{sm:"px-2 py-0.5 text-[11px]",md:"px-2.5 py-0.5 text-xs"}},defaultVariants:{variant:"default",tone:"neutral",size:"md"}}),be=xe.forwardRef(({className:e,variant:t,tone:n,size:r,...s},i)=>a.jsx("span",{ref:i,className:ud({variant:t,tone:n,size:r,className:e}),...s}));be.displayName="Badge";const Nr=[{value:"admin",label:"Amministratore"},{value:"responsabile",label:"Responsabile"},{value:"dipendente",label:"Dipendente"},{value:"collaboratore",label:"Collaboratore Occasionale / Part-time"}],tr=[{value:"Amministratore",label:"Amministratore"},{value:"Cuochi",label:"Cuochi"},{value:"Banconisti",label:"Banconisti"},{value:"Camerieri",label:"Camerieri"},{value:"Addetto Pulizie",label:"Addetto Pulizie"},{value:"Magazziniere",label:"Magazziniere"},{value:"Social & Media Manager",label:"Social & Media Manager"},{value:"Altro",label:"Altro"}],nr=["Cuochi","Banconisti","Camerieri","Addetto Pulizie","Magazziniere"];var Y;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of i)o[l]=s[l];return e.objectValues(o)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},e.find=(s,i)=>{for(const o of s)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Y||(Y={}));var na;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(na||(na={}));const M=Y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ge=e=>{switch(typeof e){case"undefined":return M.undefined;case"string":return M.string;case"number":return Number.isNaN(e)?M.nan:M.number;case"boolean":return M.boolean;case"function":return M.function;case"bigint":return M.bigint;case"symbol":return M.symbol;case"object":return Array.isArray(e)?M.array:e===null?M.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?M.promise:typeof Map<"u"&&e instanceof Map?M.map:typeof Set<"u"&&e instanceof Set?M.set:typeof Date<"u"&&e instanceof Date?M.date:M.object;default:return M.unknown}},k=Y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ze extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(t){if(!(t instanceof Ze))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Y.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const i=s.path[0];n[i]=n[i]||[],n[i].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ze.create=e=>new Ze(e);const rr=(e,t)=>{let n;switch(e.code){case k.invalid_type:e.received===M.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case k.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Y.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:n=`Unrecognized key(s) in object: ${Y.joinValues(e.keys,", ")}`;break;case k.invalid_union:n="Invalid input";break;case k.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Y.joinValues(e.options)}`;break;case k.invalid_enum_value:n=`Invalid enum value. Expected ${Y.joinValues(e.options)}, received '${e.received}'`;break;case k.invalid_arguments:n="Invalid function arguments";break;case k.invalid_return_type:n="Invalid function return type";break;case k.invalid_date:n="Invalid date";break;case k.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Y.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case k.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case k.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case k.custom:n="Invalid input";break;case k.invalid_intersection_types:n="Intersection results could not be merged";break;case k.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case k.not_finite:n="Number must be finite";break;default:n=t.defaultError,Y.assertNever(e)}return{message:n}};let md=rr;function fd(){return md}const pd=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:t,defaultError:l}).message;return{...s,path:i,message:l}};function D(e,t){const n=fd(),r=pd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===rr?void 0:rr].filter(s=>!!s)});e.common.issues.push(r)}class we{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return q;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,o=await s.value;r.push({key:i,value:o})}return we.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return q;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:t.value,value:r}}}const q=Object.freeze({status:"aborted"}),Dt=e=>({status:"dirty",value:e}),_e=e=>({status:"valid",value:e}),ra=e=>e.status==="aborted",aa=e=>e.status==="dirty",jt=e=>e.status==="valid",cn=e=>typeof Promise<"u"&&e instanceof Promise;var B;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(B||(B={}));class tt{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const sa=(e,t)=>{if(jt(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ze(e.common.issues);return this._error=n,this._error}}};function W(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(o,l)=>{const{message:c}=e;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??n??l.defaultError}},description:s}}class G{get description(){return this._def.description}_getType(t){return Ge(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Ge(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new we,ctx:{common:t.parent.common,data:t.data,parsedType:Ge(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(cn(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ge(t)},s=this._parseSync({data:t,path:r.path,parent:r});return sa(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ge(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return jt(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>jt(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ge(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(cn(s)?s:Promise.resolve(s));return sa(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=t(s),l=()=>i.addIssue({code:k.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new _t({schema:this,typeName:H.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Xe.create(this,this._def)}nullable(){return At.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ze.create(this)}promise(){return fn.create(this,this._def)}or(t){return un.create([this,t],this._def)}and(t){return mn.create(this,t,this._def)}transform(t){return new _t({...W(this._def),schema:this,typeName:H.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new lr({...W(this._def),innerType:this,defaultValue:n,typeName:H.ZodDefault})}brand(){return new Md({typeName:H.ZodBranded,type:this,...W(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new cr({...W(this._def),innerType:this,catchValue:n,typeName:H.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Sr.create(this,t)}readonly(){return dr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const hd=/^c[^\s-]{8,}$/i,gd=/^[0-9a-z]+$/,xd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,vd=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bd=/^[a-z0-9_-]{21}$/i,yd=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,wd=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Cd=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,jd="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Mn;const Nd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Sd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_d=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ad=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Td=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ed=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Qs="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Rd=new RegExp(`^${Qs}$`);function Js(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function kd(e){return new RegExp(`^${Js(e)}$`)}function Id(e){let t=`${Qs}T${Js(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Pd(e,t){return!!((t==="v4"||!t)&&Nd.test(e)||(t==="v6"||!t)&&_d.test(e))}function Od(e,t){if(!yd.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Dd(e,t){return!!((t==="v4"||!t)&&Sd.test(e)||(t==="v6"||!t)&&Ad.test(e))}class Ye extends G{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==M.string){const i=this._getOrReturnCtx(t);return D(i,{code:k.invalid_type,expected:M.string,received:i.parsedType}),q}const r=new we;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),D(s,{code:k.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),D(s,{code:k.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(s=this._getOrReturnCtx(t,s),o?D(s,{code:k.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&D(s,{code:k.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Cd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"email",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Mn||(Mn=new RegExp(jd,"u")),Mn.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"emoji",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")vd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"uuid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")bd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"nanoid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")hd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"cuid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")gd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"cuid2",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")xd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"ulid",code:k.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),D(s,{validation:"url",code:k.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"regex",code:k.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Id(i).test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Rd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?kd(i).test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{code:k.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?wd.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"duration",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Pd(t.data,i.version)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"ip",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Od(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"jwt",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Dd(t.data,i.version)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"cidr",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Td.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"base64",code:k.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Ed.test(t.data)||(s=this._getOrReturnCtx(t,s),D(s,{validation:"base64url",code:k.invalid_string,message:i.message}),r.dirty()):Y.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:k.invalid_string,...B.errToObj(r)})}_addCheck(t){return new Ye({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...B.errToObj(t)})}url(t){return this._addCheck({kind:"url",...B.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...B.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...B.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...B.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...B.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...B.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...B.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...B.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...B.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...B.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...B.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...B.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...B.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...B.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...B.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...B.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...B.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...B.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...B.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...B.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...B.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...B.errToObj(n)})}nonempty(t){return this.min(1,B.errToObj(t))}trim(){return new Ye({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ye({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ye({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ye.create=e=>new Ye({checks:[],typeName:H.ZodString,coerce:e?.coerce??!1,...W(e)});function zd(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),o=Number.parseInt(t.toFixed(s).replace(".",""));return i%o/10**s}class Nt extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==M.number){const i=this._getOrReturnCtx(t);return D(i,{code:k.invalid_type,expected:M.number,received:i.parsedType}),q}let r;const s=new we;for(const i of this._def.checks)i.kind==="int"?Y.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),D(r,{code:k.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?zd(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),D(r,{code:k.not_finite,message:i.message}),s.dirty()):Y.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,B.toString(n))}gt(t,n){return this.setLimit("min",t,!1,B.toString(n))}lte(t,n){return this.setLimit("max",t,!0,B.toString(n))}lt(t,n){return this.setLimit("max",t,!1,B.toString(n))}setLimit(t,n,r,s){return new Nt({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:B.toString(s)}]})}_addCheck(t){return new Nt({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:B.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:B.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:B.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:B.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:B.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Y.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Nt.create=e=>new Nt({checks:[],typeName:H.ZodNumber,coerce:e?.coerce||!1,...W(e)});class $t extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==M.bigint)return this._getInvalidInput(t);let r;const s=new we;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),D(r,{code:k.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Y.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return D(n,{code:k.invalid_type,expected:M.bigint,received:n.parsedType}),q}gte(t,n){return this.setLimit("min",t,!0,B.toString(n))}gt(t,n){return this.setLimit("min",t,!1,B.toString(n))}lte(t,n){return this.setLimit("max",t,!0,B.toString(n))}lt(t,n){return this.setLimit("max",t,!1,B.toString(n))}setLimit(t,n,r,s){return new $t({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:B.toString(s)}]})}_addCheck(t){return new $t({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:B.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}$t.create=e=>new $t({checks:[],typeName:H.ZodBigInt,coerce:e?.coerce??!1,...W(e)});class ar extends G{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==M.boolean){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.boolean,received:r.parsedType}),q}return _e(t.data)}}ar.create=e=>new ar({typeName:H.ZodBoolean,coerce:e?.coerce||!1,...W(e)});class dn extends G{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==M.date){const i=this._getOrReturnCtx(t);return D(i,{code:k.invalid_type,expected:M.date,received:i.parsedType}),q}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return D(i,{code:k.invalid_date}),q}const r=new we;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),D(s,{code:k.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),D(s,{code:k.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Y.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new dn({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:B.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:B.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}dn.create=e=>new dn({checks:[],coerce:e?.coerce||!1,typeName:H.ZodDate,...W(e)});class ia extends G{_parse(t){if(this._getType(t)!==M.symbol){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.symbol,received:r.parsedType}),q}return _e(t.data)}}ia.create=e=>new ia({typeName:H.ZodSymbol,...W(e)});class oa extends G{_parse(t){if(this._getType(t)!==M.undefined){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.undefined,received:r.parsedType}),q}return _e(t.data)}}oa.create=e=>new oa({typeName:H.ZodUndefined,...W(e)});class la extends G{_parse(t){if(this._getType(t)!==M.null){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.null,received:r.parsedType}),q}return _e(t.data)}}la.create=e=>new la({typeName:H.ZodNull,...W(e)});class ca extends G{constructor(){super(...arguments),this._any=!0}_parse(t){return _e(t.data)}}ca.create=e=>new ca({typeName:H.ZodAny,...W(e)});class da extends G{constructor(){super(...arguments),this._unknown=!0}_parse(t){return _e(t.data)}}da.create=e=>new da({typeName:H.ZodUnknown,...W(e)});class nt extends G{_parse(t){const n=this._getOrReturnCtx(t);return D(n,{code:k.invalid_type,expected:M.never,received:n.parsedType}),q}}nt.create=e=>new nt({typeName:H.ZodNever,...W(e)});class ua extends G{_parse(t){if(this._getType(t)!==M.undefined){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.void,received:r.parsedType}),q}return _e(t.data)}}ua.create=e=>new ua({typeName:H.ZodVoid,...W(e)});class ze extends G{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==M.array)return D(n,{code:k.invalid_type,expected:M.array,received:n.parsedType}),q;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,l=n.data.length<s.exactLength.value;(o||l)&&(D(n,{code:o?k.too_big:k.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(D(n,{code:k.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(D(n,{code:k.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,l)=>s.type._parseAsync(new tt(n,o,n.path,l)))).then(o=>we.mergeArray(r,o));const i=[...n.data].map((o,l)=>s.type._parseSync(new tt(n,o,n.path,l)));return we.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new ze({...this._def,minLength:{value:t,message:B.toString(n)}})}max(t,n){return new ze({...this._def,maxLength:{value:t,message:B.toString(n)}})}length(t,n){return new ze({...this._def,exactLength:{value:t,message:B.toString(n)}})}nonempty(t){return this.min(1,t)}}ze.create=(e,t)=>new ze({type:e,minLength:null,maxLength:null,exactLength:null,typeName:H.ZodArray,...W(t)});function vt(e){if(e instanceof le){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Xe.create(vt(r))}return new le({...e._def,shape:()=>t})}else return e instanceof ze?new ze({...e._def,type:vt(e.element)}):e instanceof Xe?Xe.create(vt(e.unwrap())):e instanceof At?At.create(vt(e.unwrap())):e instanceof ft?ft.create(e.items.map(t=>vt(t))):e}class le extends G{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Y.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==M.object){const d=this._getOrReturnCtx(t);return D(d,{code:k.invalid_type,expected:M.object,received:d.parsedType}),q}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof nt&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],x=s.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new tt(s,x,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof nt){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(d==="strict")l.length>0&&(D(s,{code:k.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const x=s.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new tt(s,x,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const x=await u.key,b=await u.value;d.push({key:x,value:b,alwaysSet:u.alwaysSet})}return d}).then(d=>we.mergeObjectSync(r,d)):we.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return B.errToObj,new le({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:B.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new le({...this._def,unknownKeys:"strip"})}passthrough(){return new le({...this._def,unknownKeys:"passthrough"})}extend(t){return new le({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new le({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:H.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new le({...this._def,catchall:t})}pick(t){const n={};for(const r of Y.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new le({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Y.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new le({...this._def,shape:()=>n})}deepPartial(){return vt(this)}partial(t){const n={};for(const r of Y.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new le({...this._def,shape:()=>n})}required(t){const n={};for(const r of Y.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Xe;)i=i._def.innerType;n[r]=i}return new le({...this._def,shape:()=>n})}keyof(){return ei(Y.objectKeys(this.shape))}}le.create=(e,t)=>new le({shape:()=>e,unknownKeys:"strip",catchall:nt.create(),typeName:H.ZodObject,...W(t)});le.strictCreate=(e,t)=>new le({shape:()=>e,unknownKeys:"strict",catchall:nt.create(),typeName:H.ZodObject,...W(t)});le.lazycreate=(e,t)=>new le({shape:e,unknownKeys:"strip",catchall:nt.create(),typeName:H.ZodObject,...W(t)});class un extends G{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new Ze(l.ctx.common.issues));return D(n,{code:k.invalid_union,unionErrors:o}),q}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const d={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new Ze(c));return D(n,{code:k.invalid_union,unionErrors:l}),q}}get options(){return this._def.options}}un.create=(e,t)=>new un({options:e,typeName:H.ZodUnion,...W(t)});function sr(e,t){const n=Ge(e),r=Ge(t);if(e===t)return{valid:!0,data:e};if(n===M.object&&r===M.object){const s=Y.objectKeys(t),i=Y.objectKeys(e).filter(l=>s.indexOf(l)!==-1),o={...e,...t};for(const l of i){const c=sr(e[l],t[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(n===M.array&&r===M.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const o=e[i],l=t[i],c=sr(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===M.date&&r===M.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class mn extends G{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,o)=>{if(ra(i)||ra(o))return q;const l=sr(i.value,o.value);return l.valid?((aa(i)||aa(o))&&n.dirty(),{status:n.value,value:l.data}):(D(r,{code:k.invalid_intersection_types}),q)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}mn.create=(e,t,n)=>new mn({left:e,right:t,typeName:H.ZodIntersection,...W(n)});class ft extends G{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==M.array)return D(r,{code:k.invalid_type,expected:M.array,received:r.parsedType}),q;if(r.data.length<this._def.items.length)return D(r,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),q;!this._def.rest&&r.data.length>this._def.items.length&&(D(r,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new tt(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>we.mergeArray(n,o)):we.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new ft({...this._def,rest:t})}}ft.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ft({items:e,typeName:H.ZodTuple,rest:null,...W(t)})};class ma extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==M.map)return D(r,{code:k.invalid_type,expected:M.map,received:r.parsedType}),q;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new tt(r,l,r.path,[d,"key"])),value:i._parse(new tt(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return q;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return q;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}}}}ma.create=(e,t,n)=>new ma({valueType:t,keyType:e,typeName:H.ZodMap,...W(n)});class Ft extends G{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==M.set)return D(r,{code:k.invalid_type,expected:M.set,received:r.parsedType}),q;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(D(r,{code:k.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(D(r,{code:k.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return q;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const l=[...r.data.values()].map((c,d)=>i._parse(new tt(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(t,n){return new Ft({...this._def,minSize:{value:t,message:B.toString(n)}})}max(t,n){return new Ft({...this._def,maxSize:{value:t,message:B.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Ft.create=(e,t)=>new Ft({valueType:e,minSize:null,maxSize:null,typeName:H.ZodSet,...W(t)});class fa extends G{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}fa.create=(e,t)=>new fa({getter:e,typeName:H.ZodLazy,...W(t)});class ir extends G{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return D(n,{received:n.data,code:k.invalid_literal,expected:this._def.value}),q}return{status:"valid",value:t.data}}get value(){return this._def.value}}ir.create=(e,t)=>new ir({value:e,typeName:H.ZodLiteral,...W(t)});function ei(e,t){return new St({values:e,typeName:H.ZodEnum,...W(t)})}class St extends G{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return D(n,{expected:Y.joinValues(r),received:n.parsedType,code:k.invalid_type}),q}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return D(n,{received:n.data,code:k.invalid_enum_value,options:r}),q}return _e(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return St.create(t,{...this._def,...n})}exclude(t,n=this._def){return St.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}St.create=ei;class or extends G{_parse(t){const n=Y.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==M.string&&r.parsedType!==M.number){const s=Y.objectValues(n);return D(r,{expected:Y.joinValues(s),received:r.parsedType,code:k.invalid_type}),q}if(this._cache||(this._cache=new Set(Y.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Y.objectValues(n);return D(r,{received:r.data,code:k.invalid_enum_value,options:s}),q}return _e(t.data)}get enum(){return this._def.values}}or.create=(e,t)=>new or({values:e,typeName:H.ZodNativeEnum,...W(t)});class fn extends G{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==M.promise&&n.common.async===!1)return D(n,{code:k.invalid_type,expected:M.promise,received:n.parsedType}),q;const r=n.parsedType===M.promise?n.data:Promise.resolve(n.data);return _e(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}fn.create=(e,t)=>new fn({type:e,typeName:H.ZodPromise,...W(t)});class _t extends G{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===H.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:o=>{D(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async l=>{if(n.value==="aborted")return q;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?q:c.status==="dirty"||n.value==="dirty"?Dt(c.value):c});{if(n.value==="aborted")return q;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?q:l.status==="dirty"||n.value==="dirty"?Dt(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?q:(l.status==="dirty"&&n.dirty(),o(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?q:(l.status==="dirty"&&n.dirty(),o(l.value).then(()=>({status:n.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!jt(o))return q;const l=s.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>jt(o)?Promise.resolve(s.transform(o.value,i)).then(l=>({status:n.value,value:l})):q);Y.assertNever(s)}}_t.create=(e,t,n)=>new _t({schema:e,typeName:H.ZodEffects,effect:t,...W(n)});_t.createWithPreprocess=(e,t,n)=>new _t({schema:t,effect:{type:"preprocess",transform:e},typeName:H.ZodEffects,...W(n)});class Xe extends G{_parse(t){return this._getType(t)===M.undefined?_e(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Xe.create=(e,t)=>new Xe({innerType:e,typeName:H.ZodOptional,...W(t)});class At extends G{_parse(t){return this._getType(t)===M.null?_e(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}At.create=(e,t)=>new At({innerType:e,typeName:H.ZodNullable,...W(t)});class lr extends G{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===M.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}lr.create=(e,t)=>new lr({innerType:e,typeName:H.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...W(t)});class cr extends G{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return cn(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}cr.create=(e,t)=>new cr({innerType:e,typeName:H.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...W(t)});class pa extends G{_parse(t){if(this._getType(t)!==M.nan){const r=this._getOrReturnCtx(t);return D(r,{code:k.invalid_type,expected:M.nan,received:r.parsedType}),q}return{status:"valid",value:t.data}}}pa.create=e=>new pa({typeName:H.ZodNaN,...W(e)});class Md extends G{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Sr extends G{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?q:i.status==="dirty"?(n.dirty(),Dt(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?q:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new Sr({in:t,out:n,typeName:H.ZodPipeline})}}class dr extends G{_parse(t){const n=this._def.innerType._parse(t),r=s=>(jt(s)&&(s.value=Object.freeze(s.value)),s);return cn(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}dr.create=(e,t)=>new dr({innerType:e,typeName:H.ZodReadonly,...W(t)});var H;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(H||(H={}));const U=Ye.create,wt=Nt.create,ti=ar.create;nt.create;const pt=ze.create,Tt=le.create;un.create;mn.create;ft.create;const Yt=ir.create,Ke=St.create,Ld=or.create;fn.create;Xe.create;At.create;const ni=Tt({name:U().min(2,"Il nome è obbligatorio"),surname:U().min(2,"Il cognome è obbligatorio"),email:U().email("Email non valida").optional().or(Yt("")),phone:U().regex(/^[0-9+\s-]*$/,"Numero di telefono non valido").optional().or(Yt("")),role:Ke(["admin","responsabile","dipendente","collaboratore"]),categories:pt(U()).min(1,"Seleziona almeno una categoria"),departmentAssignments:pt(U()),haccpExpiry:U().optional().or(Yt("")),notes:U().optional().or(Yt(""))}),Bd=e=>({name:e.name,surname:e.surname,email:e.email||"",phone:e.phone||"",role:e.role,categories:e.categories.length?e.categories:["Altro"],departmentAssignments:e.department_assignments||[],haccpExpiry:e.haccpExpiry||"",notes:e.notes||""}),ri=e=>e.every(t=>!nr.includes(t)),ur=e=>{const t=ni.safeParse({name:e.name,surname:e.surname,email:e.email||"",phone:e.phone||"",role:e.role,categories:e.categories,departmentAssignments:e.department_assignments||[],haccpExpiry:e.haccpExpiry||"",notes:e.notes||""});if(!t.success){const n={};return t.error.issues.forEach(r=>{r.path[0]&&(n[r.path[0]]=r.message)}),{success:!1,fieldErrors:n}}return!ri(e.categories)&&(!e.haccpExpiry||e.haccpExpiry.trim().length===0)?{success:!1,fieldErrors:{haccpExpiry:"La certificazione HACCP è obbligatoria per questa categoria"}}:{success:!0}},$d=(e,t)=>{const n=ni.safeParse(e),r={};if(!n.success)return n.error.issues.forEach(c=>{c.path[0]&&(r[c.path[0]]=c.message)}),{validation:{success:!1,fieldErrors:r}};if(!ri(e.categories)&&(!e.haccpExpiry||e.haccpExpiry.trim().length===0))return r.haccpExpiry="Inserisci la data di scadenza della certificazione HACCP",{validation:{success:!1,fieldErrors:r}};const i=Nr.some(c=>c.value===e.role)?e.role:"dipendente",o={id:t||`staff_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,name:e.name.trim(),surname:e.surname.trim(),fullName:`${e.name.trim()} ${e.surname.trim()}`,role:i,email:e.email.trim()||void 0,phone:e.phone.trim()||void 0,categories:Array.from(new Set(e.categories)),department_assignments:e.departmentAssignments,haccpExpiry:e.haccpExpiry||void 0,notes:e.notes||void 0},l=ur(o);return l.success?{member:o,validation:{success:!0}}:{validation:l}},Ln=e=>{if(!e)return{level:"missing",message:"Certificazione HACCP non registrata"};const t=new Date(e),n=new Date;if(Number.isNaN(t.getTime()))return{level:"missing",message:"Data certificazione non valida"};const r=t.getTime()-n.getTime(),s=Math.ceil(r/(1e3*60*60*24));return s<0?{level:"expired",message:`Certificato scaduto da ${Math.abs(s)} giorni`}:s<=30?{level:"warning",message:`Scade tra ${s} giorni`}:{level:"ok",message:`Valido fino al ${t.toLocaleDateString("it-IT")}`}},ha={name:"",surname:"",email:"",phone:"",role:Nr[0].value,categories:[tr[0].value],departmentAssignments:[],haccpExpiry:"",notes:""},Fd=({data:e,departments:t,onUpdate:n,onValidChange:r})=>{const[s,i]=m.useState(e||[]),[o,l]=m.useState({...ha}),[c,d]=m.useState(null),[u,x]=m.useState({}),{formRef:b,scrollToForm:C}=Oi(!!c,"staff-step-form");m.useEffect(()=>{n(s)},[s,n]),m.useEffect(()=>{const y=s.length>0&&s.every(T=>ur(T).success);r(y)},[s,r]);const w=m.useMemo(()=>t.filter(y=>y.is_active!==!1),[t]),f=()=>{l(ha),x({}),d(null)},v=y=>{d(y.id),l(Bd(y)),x({}),C()},h=y=>{i(T=>T.filter(S=>S.id!==y)),c===y&&f()},j=y=>{y.preventDefault();const{member:T,validation:S}=$d(o,c);x(S.fieldErrors||{}),!(!S.success||!T)&&(i(_=>c?_.map(N=>N.id===c?T:N):[..._,T]),f())},A=m.useMemo(()=>{if(s.length===0)return null;const y=s.filter(N=>N.categories.some(P=>nr.includes(P))),T=y.filter(N=>ur(N).success&&!!N.haccpExpiry),S=y.filter(N=>Ln(N.haccpExpiry).level==="warning"),_=y.filter(N=>Ln(N.haccpExpiry).level==="expired");return{total:s.length,requiringCertification:y.length,compliant:T.length,expiringSoon:S.length,expired:_.length}},[s]);return a.jsxs("div",{className:"space-y-6",id:"staff-step",children:[a.jsxs("header",{className:"text-center space-y-2",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestione del Personale"}),a.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Registra ruoli, categorie operative e certificazioni HACCP del personale per garantire la conformità normativa."})]}),A&&a.jsxs("section",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"rounded-lg border border-blue-100 bg-blue-50 p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Panoramica HACCP"}),a.jsxs("dl",{className:"space-y-1 text-sm text-blue-800",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("dt",{children:"Membri registrati"}),a.jsx("dd",{className:"font-semibold",children:A.total})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("dt",{children:"Richiedono certificazione"}),a.jsx("dd",{className:"font-semibold",children:A.requiringCertification})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("dt",{children:"Certificazioni valide"}),a.jsx("dd",{className:"font-semibold",children:A.compliant})]})]})]}),a.jsxs("div",{className:"rounded-lg border border-amber-100 bg-amber-50 p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-amber-900 mb-2",children:"Scadenze monitorate"}),a.jsxs("dl",{className:"space-y-1 text-sm text-amber-800",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("dt",{children:"Certificati in scadenza"}),a.jsx("dd",{className:"font-semibold",children:A.expiringSoon})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("dt",{children:"Certificati scaduti"}),a.jsx("dd",{className:"font-semibold",children:A.expired})]})]})]})]}),a.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white",children:[a.jsxs("header",{className:"border-b border-gray-100 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Staff configurato"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Elenco dei membri registrati durante l'onboarding"})]}),a.jsxs(re,{variant:"ghost",className:"gap-2",onClick:C,children:[a.jsx(lt,{className:"h-4 w-4"}),c?"Modifica membro":"Aggiungi membro"]})]}),a.jsxs("div",{className:"divide-y divide-gray-100",children:[s.length===0&&a.jsx("p",{className:"px-4 py-8 text-center text-sm text-gray-500",children:"Nessun membro dello staff registrato. Aggiungi almeno un membro per procedere."}),s.map(y=>{const T=y.categories.some(_=>nr.includes(_)),S=Ln(y.haccpExpiry);return a.jsxs("article",{className:"grid gap-4 px-4 py-3 md:grid-cols-[1fr_auto] md:items-start",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("h4",{className:"text-base font-semibold text-gray-900",children:y.fullName}),a.jsx(be,{children:y.role})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[y.email&&a.jsx(be,{variant:"secondary",children:y.email}),y.phone&&a.jsx(be,{variant:"secondary",children:y.phone})]}),a.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:y.categories.map(_=>a.jsx(be,{variant:"outline",children:_},_))}),y.department_assignments.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:y.department_assignments.map(_=>{const N=t.find(P=>P.id===_);return N?a.jsx(be,{variant:"outline",children:N.name},_):null})}),T&&a.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm",children:[S.level==="ok"?a.jsx($n,{className:"h-4 w-4 text-green-600","aria-hidden":!0}):a.jsx(Na,{className:"h-4 w-4 text-amber-600","aria-hidden":!0}),a.jsx("span",{className:S.level==="expired"?"text-red-600 font-semibold":S.level==="warning"?"text-amber-600 font-semibold":"text-green-700",children:S.message})]}),y.notes&&a.jsx("p",{className:"text-sm text-gray-500 border-l-2 border-gray-200 pl-3",children:y.notes})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(re,{variant:"outline",size:"icon",onClick:()=>v(y),"aria-label":"Modifica membro",children:a.jsx(ot,{className:"h-4 w-4","aria-hidden":!0})}),a.jsx(re,{variant:"destructive",size:"icon",onClick:()=>h(y.id),"aria-label":"Elimina membro",children:a.jsx(Qe,{className:"h-4 w-4","aria-hidden":!0})})]})]},y.id)})]})]}),a.jsxs("section",{id:"staff-step-form",ref:b,className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("header",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c?"Modifica membro dello staff":"Aggiungi nuovo membro"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Compila i campi obbligatori per registrare il personale. Le certificazioni HACCP sono richieste solo per le categorie operative."})]}),a.jsxs("form",{className:"space-y-6",onSubmit:j,children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-name",children:"Nome *"}),a.jsx(Ve,{id:"staff-name",value:o.name,onChange:y=>l(T=>({...T,name:y.target.value})),placeholder:"Mario","aria-invalid":!!u.name}),u.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.name})]}),a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-surname",children:"Cognome *"}),a.jsx(Ve,{id:"staff-surname",value:o.surname,onChange:y=>l(T=>({...T,surname:y.target.value})),placeholder:"Rossi","aria-invalid":!!u.surname}),u.surname&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.surname})]})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-email",children:"Email"}),a.jsx(Ve,{id:"staff-email",type:"email",value:o.email,onChange:y=>l(T=>({...T,email:y.target.value})),placeholder:"email@azienda.it","aria-invalid":!!u.email}),u.email&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.email})]}),a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-phone",children:"Telefono"}),a.jsx(Ve,{id:"staff-phone",value:o.phone,onChange:y=>l(T=>({...T,phone:y.target.value})),placeholder:"+39 340 1234567","aria-invalid":!!u.phone}),u.phone&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.phone})]})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-role",children:"Ruolo *"}),a.jsxs(Ee,{value:o.role,onValueChange:y=>l(T=>({...T,role:y})),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona ruolo"})}),a.jsx(Ne,{children:Nr.map(y=>a.jsx(ae,{value:y.value,children:y.label},y.value))})]})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Categorie *"}),a.jsxs("div",{className:"space-y-2",children:[o.categories.map((y,T)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Ee,{value:y,onValueChange:S=>l(_=>({..._,categories:_.categories.map((N,P)=>P===T?S:N)})),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona categoria"})}),a.jsx(Ne,{children:tr.map(S=>a.jsx(ae,{value:S.value,children:S.label},S.value))})]}),o.categories.length>1&&a.jsx(re,{type:"button",variant:"ghost",size:"icon",onClick:()=>l(S=>({...S,categories:S.categories.filter((_,N)=>N!==T)})),"aria-label":"Rimuovi categoria",children:a.jsx(Qe,{className:"h-4 w-4","aria-hidden":!0})})]},`category-${T}`)),a.jsx(re,{type:"button",variant:"outline",onClick:()=>l(y=>({...y,categories:[...y.categories,tr[0].value]})),className:"w-full",children:"Aggiungi categoria"})]})]})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Assegnazione reparti"}),a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2 rounded border border-blue-200 bg-blue-50 px-3 py-2 text-sm font-medium",children:[a.jsx("input",{type:"checkbox",checked:o.departmentAssignments.length===w.length&&w.length>0,onChange:y=>{const T=y.target.checked;l(S=>({...S,departmentAssignments:T?w.map(_=>_.id):[]}))},className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-blue-800",children:"🎯 Tutti i reparti"})]}),a.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:w.map(y=>a.jsxs("label",{className:"flex items-center gap-2 rounded border border-gray-200 bg-white px-3 py-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:o.departmentAssignments.includes(y.id),onChange:T=>{const S=T.target.checked;l(_=>({..._,departmentAssignments:S?[..._.departmentAssignments,y.id]:_.departmentAssignments.filter(N=>N!==y.id)}))},className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{children:y.name})]},y.id))})]})]}),a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-haccp-expiry",children:"Scadenza certificazione HACCP *"}),a.jsx(Ve,{id:"staff-haccp-expiry",type:"date",value:o.haccpExpiry,onChange:y=>l(T=>({...T,haccpExpiry:y.target.value})),"aria-invalid":!!u.haccpExpiry}),u.haccpExpiry&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.haccpExpiry})]}),a.jsxs("div",{children:[a.jsx(K,{htmlFor:"staff-notes",children:"Note"}),a.jsx(qt,{id:"staff-notes",value:o.notes,onChange:y=>l(T=>({...T,notes:y.target.value})),placeholder:"Aggiungi note sulla certificazione HACCP o sul membro"})]}),a.jsx(re,{type:"submit",className:"w-full",children:c?"Salva modifiche":"Aggiungi membro"})]})]})]})},en={ambient:{value:"ambient",label:"Ambiente (dispense)",temperatureRange:{min:null,max:null},color:"text-amber-600"},fridge:{value:"fridge",label:"Frigorifero",temperatureRange:{min:1,max:15},color:"text-blue-600"},freezer:{value:"freezer",label:"Congelatore",temperatureRange:{min:-25,max:-1},color:"text-cyan-600"},blast:{value:"blast",label:"Abbattitore",temperatureRange:{min:-90,max:-15},color:"text-emerald-600"}},mr=[{id:"fresh_meat",label:"Carni fresche",range:{min:1,max:4},incompatible:["ambient","blast"]},{id:"fresh_fish",label:"Pesce fresco",range:{min:1,max:2},incompatible:["ambient","blast"]},{id:"fresh_dairy",label:"Latticini",range:{min:2,max:6},incompatible:["ambient"]},{id:"fresh_produce",label:"Verdure fresche",range:{min:2,max:8},incompatible:["ambient"]},{id:"beverages",label:"Bevande",range:{min:2,max:12},incompatible:[]},{id:"dry_goods",label:"Dispensa secca",range:{min:15,max:25},compatibleTypes:["ambient"]},{id:"frozen",label:"Congelati",range:{min:-25,max:-1},compatibleTypes:["freezer"]},{id:"deep_frozen",label:"Ultracongelati",range:{min:-25,max:-1},compatibleTypes:["freezer"]},{id:"blast_chilling",label:"Abbattimento rapido",range:{min:-90,max:-15},compatibleTypes:["blast"]}],Vd=Object.keys(wi),qd=["daily","weekly","monthly","quarterly","annual","custom","as_needed"],Hd=Tt({id:U(),conservationPointId:U().min(1,"Associa il punto di conservazione"),conservationPointName:U().optional(),title:U().min(2,"Il titolo è obbligatorio"),type:Ke(Vd),frequency:Ke(qd),assignedRole:U().optional(),assignedStaffIds:pt(U()).default([]),notes:U().optional(),estimatedDuration:wt().min(1).optional(),priority:Ke(["low","medium","high","critical"]).optional(),nextDue:U().optional(),instructions:pt(U()).optional(),status:Ke(["scheduled","in_progress","completed","overdue","skipped"]).optional()}),Zd=Tt({id:U(),name:U().min(2,"Il nome deve essere di almeno 2 caratteri"),departmentId:U().min(1,"Seleziona il reparto a cui appartiene il punto di conservazione"),targetTemperature:wt({invalid_type_error:"Inserisci una temperatura valida"}).min(-99).max(80),pointType:Ke(["ambient","fridge","freezer","blast"]),isBlastChiller:ti(),productCategories:pt(U()).min(1,"Seleziona almeno una categoria"),source:Ke(["manual","prefill","import"]),maintenanceTasks:pt(Hd).optional()}),Bn=e=>{const t=Zd.safeParse(e);if(!t.success){const s={};return t.error.issues.forEach(i=>{i.path[0]&&(s[i.path[0].toString()]=i.message)}),{success:!1,errors:s}}const n=e.productCategories.filter(s=>{const i=zt(s);return i?i.compatibleTypes&&!i.compatibleTypes.includes(e.pointType)?!0:i.incompatible?.includes(e.pointType):!1});if(n.length>0)return{success:!1,errors:{productCategories:"Alcune categorie non sono compatibili con la tipologia selezionata",global:`Rimuovi le categorie incompatibili: ${n.map(s=>zt(s)?.label||s).join(", ")}`}};const r=e.productCategories.filter(s=>{const i=zt(s);if(!i)return!1;const o=i.range,l=e.targetTemperature;return l<o.min||l>o.max});return r.length>0?{success:!1,errors:{targetTemperature:"La temperatura non rientra nei range HACCP delle categorie selezionate",global:`Verifica i range per: ${r.map(s=>zt(s)?.label||s).join(", ")}`}}:{success:!0,point:e}},$e=()=>`cp_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,Ud=e=>e?{...e,productCategories:[...e.productCategories],maintenanceTasks:e.maintenanceTasks?e.maintenanceTasks.map(t=>({...t,assignedStaffIds:[...t.assignedStaffIds],instructions:[...t.instructions??[]],status:t.status??"scheduled"})):[]}:{id:$e(),name:"",departmentId:"",targetTemperature:4,pointType:"fridge",isBlastChiller:!1,productCategories:[],maintenanceTasks:[],source:"manual"},Be=e=>({id:e.id,name:e.name.trim(),departmentId:e.departmentId,targetTemperature:e.targetTemperature,pointType:e.pointType,isBlastChiller:e.isBlastChiller,productCategories:[...e.productCategories],maintenanceTasks:e.maintenanceTasks?.map(Wd),maintenanceDue:e.maintenanceDue,source:e.source}),Wd=e=>({id:e.id,conservationPointId:e.conservationPointId,conservationPointName:e.conservationPointName,title:e.title.trim(),type:e.type,frequency:e.frequency,assignedRole:e.assignedRole,assignedStaffIds:[...e.assignedStaffIds],notes:e.notes,estimatedDuration:e.estimatedDuration,priority:e.priority,nextDue:e.nextDue,instructions:[...e.instructions??[]],status:e.status??"scheduled"}),zt=e=>mr.find(t=>t.id===e),ga=(e,t)=>{const r=en[t].temperatureRange;return t==="ambient"?{valid:!1,message:"La temperatura non è impostabile per i punti di tipo Ambiente"}:r.min!==null&&e<r.min?{valid:!1,message:`Temperatura troppo bassa. Minimo consentito: ${r.min}°C`}:r.max!==null&&e>r.max?{valid:!1,message:`Temperatura troppo alta. Massimo consentito: ${r.max}°C`}:{valid:!0}},Gd=(e,t)=>e?mr.filter(n=>n.compatibleTypes&&!n.compatibleTypes.includes(t)||n.incompatible&&n.incompatible.includes(t)?!1:n.range?e>=n.range.min&&e<=n.range.max:!0):mr,xa={name:"",departmentId:"",targetTemperature:"",pointType:"fridge",isBlastChiller:!1,productCategories:[]},Yd=({data:e,departments:t,onUpdate:n,onValidChange:r})=>{const[s,i]=m.useState((e?.points??[]).map(Be)),[o,l]=m.useState({...xa}),[c,d]=m.useState(null),[u,x]=m.useState({}),[b,C]=m.useState(null);m.useEffect(()=>{n({points:s})},[s,n]),m.useEffect(()=>{const S=s.length>0&&s.every(_=>Bn(_).success);r(S)},[s,r]),m.useEffect(()=>{if(o.targetTemperature&&o.pointType!=="ambient"){const S=Number(o.targetTemperature);if(isNaN(S))C(null);else{const _=ga(S,o.pointType);C(_.valid?null:_.message||null)}}else C(null)},[o.targetTemperature,o.pointType]);const w=m.useMemo(()=>t.filter(S=>S.is_active!==!1),[t]),f=m.useMemo(()=>en[o.pointType],[o.pointType]),v=m.useMemo(()=>{const S=o.targetTemperature?Number(o.targetTemperature):null;return Gd(S,o.pointType)},[o.targetTemperature,o.pointType]),h=()=>{l(xa),d(null),x({}),C(null)},j=S=>{const _=Ud(S);d(S.id),l({name:_.name,departmentId:_.departmentId,targetTemperature:_.targetTemperature.toString(),pointType:_.pointType,isBlastChiller:_.isBlastChiller,productCategories:_.productCategories}),x({}),C(null)},A=S=>{i(_=>_.filter(N=>N.id!==S)),c===S&&h()},y=S=>{S.preventDefault();const _=Be({id:c??$e(),name:o.name.trim(),departmentId:o.departmentId,targetTemperature:Number(o.targetTemperature),pointType:o.pointType,isBlastChiller:o.isBlastChiller,productCategories:[...new Set(o.productCategories)],maintenanceTasks:[]}),N=Bn(_);if(o.pointType!=="ambient"&&o.targetTemperature){const P=Number(o.targetTemperature);if(!isNaN(P)){const L=ga(P,o.pointType);if(!L.valid){x({...N.errors,targetTemperature:L.message||"Temperatura non valida"});return}}}if(!N.success){x(N.errors??{});return}i(P=>c?P.map(L=>L.id===c?_:L):[...P,_]),h()},T=()=>{if(w.length===0)return;const S=w.find(P=>P.name.toLowerCase()==="cucina"),_=w.find(P=>P.name.toLowerCase()==="bancone"),N=[Be({id:$e(),name:"Frigo A",departmentId:S?.id??w[0].id,targetTemperature:4,pointType:"fridge",isBlastChiller:!1,productCategories:["fresh_meat","fresh_dairy"]}),Be({id:$e(),name:"Freezer A",departmentId:S?.id??w[0].id,targetTemperature:-18,pointType:"freezer",isBlastChiller:!1,productCategories:["frozen","deep_frozen"]}),Be({id:$e(),name:"Freezer B",departmentId:S?.id??w[0].id,targetTemperature:-20,pointType:"freezer",isBlastChiller:!1,productCategories:["frozen","deep_frozen"]}),Be({id:$e(),name:"Abbattitore",departmentId:S?.id??w[0].id,targetTemperature:-25,pointType:"blast",isBlastChiller:!0,productCategories:["blast_chilling"]}),Be({id:$e(),name:"Frigo 1",departmentId:_?.id??w[0].id,targetTemperature:2,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"]}),Be({id:$e(),name:"Frigo 2",departmentId:_?.id??w[0].id,targetTemperature:3,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"]}),Be({id:$e(),name:"Frigo 3",departmentId:_?.id??w[0].id,targetTemperature:5,pointType:"fridge",isBlastChiller:!1,productCategories:["beverages","fresh_produce"]})];i(N),h()};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("header",{className:"space-y-2 text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Punti di conservazione"}),a.jsx("p",{className:"mx-auto max-w-2xl text-gray-600",children:"Configura frigoriferi, congelatori e abbattitori assicurando i range HACCP corretti per le categorie di prodotto gestite."})]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs(re,{variant:"outline",onClick:T,className:"gap-2",children:[a.jsx(lt,{className:"h-4 w-4"})," Carica punti predefiniti"]})}),a.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white",children:[a.jsxs("header",{className:"flex items-center justify-between border-b border-gray-100 px-4 py-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Punti configurati"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Elenco dei punti di conservazione creati durante l'onboarding"})]}),a.jsxs(re,{variant:"ghost",className:"gap-2",onClick:()=>d(null),children:[a.jsx(lt,{className:"h-4 w-4"})," ",c?"Modifica punto":"Aggiungi punto"]})]}),a.jsxs("div",{className:"divide-y divide-gray-100",children:[s.length===0&&a.jsx("p",{className:"px-4 py-8 text-center text-sm text-gray-500",children:"Nessun punto di conservazione configurato. Aggiungi almeno un punto per procedere."}),s.map(S=>{const _=t.find(L=>L.id===S.departmentId),N=Bn(S),P=en[S.pointType];return a.jsxs("article",{className:"grid gap-4 px-4 py-3 md:grid-cols-[1fr_auto] md:items-start",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx(Fn,{className:`h-4 w-4 ${P.color}`,"aria-hidden":!0}),a.jsx("h4",{className:"text-base font-semibold text-gray-900",children:S.name}),a.jsx(be,{variant:"outline",children:P.label}),S.isBlastChiller&&a.jsx(be,{tone:"warning",variant:"outline",children:"Abbattitore"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[_&&a.jsx(be,{variant:"outline",children:_.name}),a.jsxs(be,{variant:"secondary",children:[S.targetTemperature,"°C"]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:S.productCategories.map(L=>{const $=zt(L);return $?a.jsx(be,{variant:"outline",children:$.label},$.id):null})}),a.jsxs("div",{className:`flex items-center gap-2 rounded border px-3 py-2 text-sm ${N.success?"border-green-200 bg-green-50 text-green-700":"border-amber-200 bg-amber-50 text-amber-700"}`,children:[N.success?a.jsx($n,{className:"h-4 w-4","aria-hidden":!0}):a.jsx(Na,{className:"h-4 w-4","aria-hidden":!0}),a.jsx("span",{children:N.success?"Punto conforme ai requisiti HACCP":N.errors?.global||"Verifica categorie selezionate e temperatura impostata"})]}),S.maintenanceTasks&&S.maintenanceTasks.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Task programmati:"}),a.jsx("ul",{className:"space-y-1 text-xs text-gray-600",children:S.maintenanceTasks.map(L=>a.jsxs("li",{children:["• ",L.title," (",L.frequency,")"]},L.id))})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(re,{variant:"outline",size:"icon",onClick:()=>j(S),children:a.jsx(ot,{className:"h-4 w-4","aria-hidden":!0})}),a.jsx(re,{variant:"destructive",size:"icon",onClick:()=>A(S.id),children:a.jsx(Qe,{className:"h-4 w-4","aria-hidden":!0})})]})]},S.id)})]})]}),a.jsxs("section",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("header",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c?"Modifica punto di conservazione":"Aggiungi nuovo punto di conservazione"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Compila i campi obbligatori per definire il punto di conservazione e le relative attività."})]}),a.jsxs("form",{className:"space-y-6",onSubmit:y,children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{htmlFor:"point-name",children:"Nome *"}),a.jsx(Ve,{id:"point-name",value:o.name,onChange:S=>l(_=>({..._,name:S.target.value})),placeholder:"Frigo principale cucina","aria-invalid":!!u.name}),u.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.name})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Reparto *"}),a.jsxs(Ee,{value:o.departmentId||void 0,onValueChange:S=>l(_=>({..._,departmentId:S})),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona un reparto"})}),a.jsx(Ne,{children:w.map(S=>a.jsx(ae,{value:S.id,children:S.name},S.id))})]}),u.departmentId&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.departmentId})]})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsxs(K,{htmlFor:"point-temperature",children:["Temperatura target ",o.pointType==="ambient"?"":"*"]}),a.jsx(Ve,{id:"point-temperature",type:"number",step:"0.1",min:"-99",max:"30",value:o.targetTemperature,onChange:S=>l(_=>({..._,targetTemperature:S.target.value})),placeholder:o.pointType==="ambient"?"Non impostabile":String(f.temperatureRange.min),disabled:o.pointType==="ambient",className:o.pointType==="ambient"?"bg-gray-100 cursor-not-allowed":"","aria-invalid":!!(u.targetTemperature||b)}),o.pointType!=="ambient"?a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Range consigliato ",f.temperatureRange.min,"°C -"," ",f.temperatureRange.max,"°C"]}):a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"La temperatura non è impostabile per i punti di tipo Ambiente"}),u.targetTemperature&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.targetTemperature}),b&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:b})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Tipologia"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.values(en).map(S=>{const _=o.pointType===S.value;return a.jsxs(re,{type:"button",variant:_?"default":"outline",className:`justify-start gap-2 transition-all duration-200 ${_?"bg-blue-600 text-white border-blue-600 shadow-md":"bg-white text-gray-700 border-gray-300 hover:bg-blue-50 hover:border-blue-300 hover:text-blue-700"}`,onClick:()=>l(N=>({...N,pointType:S.value,isBlastChiller:S.value==="blast"})),children:[a.jsx(Fn,{className:`h-4 w-4 ${_?"text-white":S.color}`}),a.jsx("span",{className:"font-medium",children:S.label})]},S.value)})})]})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Categorie prodotti *"}),a.jsx("p",{className:"mb-3 text-sm text-gray-600",children:"Seleziona le categorie di prodotti che verranno conservate in questo punto di conservazione. Solo le categorie compatibili con la temperatura impostata sono disponibili."}),a.jsx("div",{className:"grid gap-2 md:grid-cols-2 lg:grid-cols-3",children:v.map(S=>{const _=o.productCategories.includes(S.id);return a.jsxs("button",{type:"button",className:`flex items-center justify-between rounded border p-2 text-sm transition-colors ${_?"border-blue-400 bg-blue-50 text-blue-900":"border-gray-200 bg-white hover:border-blue-200"}`,onClick:()=>{l(N=>({...N,productCategories:_?N.productCategories.filter(P=>P!==S.id):[...N.productCategories,S.id]}))},children:[a.jsx("span",{children:S.label}),S.range&&a.jsxs("span",{className:"text-xs text-gray-500",children:[S.range.min,"°C - ",S.range.max,"°C"]}),_&&a.jsx($n,{className:"h-4 w-4 text-blue-600","aria-hidden":!0})]},S.id)})}),v.length===0&&o.targetTemperature&&a.jsxs("p",{className:"mt-1 text-sm text-amber-600",children:["Nessuna categoria compatibile con la temperatura"," ",o.targetTemperature,"°C"]}),u.productCategories&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.productCategories})]}),a.jsx("div",{className:"grid gap-4 md:grid-cols-1",children:a.jsxs("div",{children:[a.jsx(K,{children:"Note operative"}),a.jsx(qt,{rows:2,value:u.global?u.global:"",readOnly:!0,className:"border-dashed text-sm text-amber-600"})]})}),a.jsx(re,{type:"submit",className:"w-full",children:c?"Salva modifiche":"Aggiungi punto"})]})]})]})},it=[{value:"rilevamento_temperatura",label:"Rilevamento Temperatura",icon:"🌡️"},{value:"sanificazione",label:"Sanificazione",icon:"🧽"},{value:"sbrinamento",label:"Sbrinamento",icon:"❄️"},{value:"controllo_scadenze",label:"Controllo Scadenze",icon:"📅"}],pn=[{value:"annuale",label:"Annuale"},{value:"mensile",label:"Mensile"},{value:"settimanale",label:"Settimanale"},{value:"giornaliera",label:"Giornaliera"},{value:"custom",label:"Personalizzata"}],ai=[{value:"lunedi",label:"Lunedì"},{value:"martedi",label:"Martedì"},{value:"mercoledi",label:"Mercoledì"},{value:"giovedi",label:"Giovedì"},{value:"venerdi",label:"Venerdì"},{value:"sabato",label:"Sabato"},{value:"domenica",label:"Domenica"}],Kd=({data:e,conservationPoints:t,staff:n,onUpdate:r,onValidChange:s})=>{const[i,o]=m.useState(e?.conservationMaintenancePlans??[]),[l,c]=m.useState(e?.genericTasks??[]),[d,u]=m.useState(null),[x,b]=m.useState(null);m.useEffect(()=>{e?.conservationMaintenancePlans!==void 0&&o(e.conservationMaintenancePlans)},[e?.conservationMaintenancePlans]),m.useEffect(()=>{e?.genericTasks!==void 0&&c(e.genericTasks)},[e?.genericTasks]);const C=m.useMemo(()=>(n??[]).map(N=>({id:N.id,label:N.fullName,role:N.role,categories:N.categories||[],department:N.department_assignments})),[n]),w=m.useCallback(()=>t.every(N=>{const P=i.filter($=>$.conservationPointId===N.id);return(N.pointType==="ambient"?it.filter($=>$.value!=="sbrinamento"):it).every($=>P.some(F=>F.manutenzione===$.value&&F.frequenza&&F.assegnatoARuolo&&(F.frequenza!=="custom"||F.giorniCustom&&F.giorniCustom.length>0)))}),[t,i]);m.useEffect(()=>{const N={conservationMaintenancePlans:i,generalTasks:[],maintenanceTasks:e?.maintenanceTasks??[],genericTasks:l};r(N)},[i,l,r,e?.maintenanceTasks]),m.useEffect(()=>{const N=w(),P=l.length>0;s(N&&P)},[w,l,s]);const f=m.useCallback(N=>{b(N)},[]),v=m.useCallback(()=>{b(null)},[]),h=m.useCallback(N=>{o(P=>[...P.filter($=>$.conservationPointId!==N[0]?.conservationPointId),...N]),b(null)},[]),j=m.useCallback(()=>{const N={id:`generic-${Date.now()}`,name:"",frequenza:"settimanale",assegnatoARuolo:"dipendente",note:""};c(P=>[...P,N]),u(N.id)},[]),A=m.useCallback((N,P)=>{c(L=>L.map($=>$.id===N?{...$,...P}:$))},[]),y=m.useCallback(N=>{c(P=>P.filter(L=>L.id!==N))},[]),T=m.useCallback(()=>{u(null)},[]),S=()=>x?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-lg bg-white p-6",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Assegna Manutenzioni - ",x.name]}),a.jsx(re,{variant:"outline",onClick:v,children:"✕"})]}),a.jsx(Xd,{conservationPoint:x,staffOptions:C,maintenancePlans:i,onSave:h,onCancel:v})]})}):null,_=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"👥 Attività/Mansioni Generiche"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Crea attività generiche e assegna responsabilità al personale"})]}),a.jsxs(re,{onClick:j,className:"gap-2",children:[a.jsx(lt,{className:"h-4 w-4"})," Aggiungi Attività"]})]}),l.length===0&&a.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center",children:a.jsx("p",{className:"text-gray-500",children:"Nessuna attività generica configurata. Aggiungi almeno un'attività per procedere."})}),l.filter(N=>d===N.id).length>0&&a.jsx("div",{className:"space-y-4",children:l.filter(N=>d===N.id).map(N=>a.jsx(Qd,{task:N,staffOptions:C,isEditing:!0,onUpdate:P=>A(N.id,P),onDelete:()=>y(N.id),onConfirm:()=>T()},N.id))}),l.filter(N=>d!==N.id).length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white",children:[a.jsx("div",{className:"border-b border-gray-100 px-4 py-3",children:a.jsx("h4",{className:"font-semibold text-gray-900",children:"Attività Configurate"})}),a.jsx("div",{className:"divide-y divide-gray-100",children:l.filter(N=>d!==N.id).map(N=>a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:N.name}),a.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[a.jsxs("span",{children:["🔄 ",pn.find(P=>P.value===N.frequenza)?.label]}),a.jsxs("span",{children:["👤 ",N.assegnatoARuolo]}),N.assegnatoACategoria&&N.assegnatoACategoria!=="all"&&a.jsxs("span",{children:["📂 ",N.assegnatoACategoria]}),N.assegnatoADipendenteSpecifico&&a.jsxs("span",{children:["👨‍💼 ",C.find(P=>P.id===N.assegnatoADipendenteSpecifico)?.label]})]}),N.note&&a.jsx("p",{className:"text-sm text-gray-600",children:N.note})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(re,{variant:"outline",size:"icon",onClick:()=>u(N.id),children:a.jsx(ot,{className:"h-4 w-4"})}),a.jsx(re,{variant:"destructive",size:"icon",onClick:()=>y(N.id),children:a.jsx(Qe,{className:"h-4 w-4"})})]})]})},N.id))})]})]});return a.jsxs("div",{className:"space-y-8",children:[a.jsxs("header",{className:"space-y-2 text-center",children:[a.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-blue-100",children:a.jsx(fi,{className:"h-8 w-8 text-blue-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Attività e controlli HACCP"}),a.jsx("p",{className:"text-gray-600",children:"Definisci le attività periodiche per garantire la conformità alle normative HACCP."})]}),a.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"🔧 Manutenzioni Punti di Conservazione"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Assegna le manutenzioni obbligatorie per ogni punto di conservazione"})]})}),a.jsx("div",{className:"space-y-3",children:t.length===0?a.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center",children:a.jsx("p",{className:"text-gray-500",children:"Nessun punto di conservazione configurato. Completa lo Step 4 per procedere."})}):t.map(N=>{const P=i.filter(F=>F.conservationPointId===N.id),$=(N.pointType==="ambient"?it.filter(F=>F.value!=="sbrinamento"):it).every(F=>P.some(E=>E.manutenzione===F.value));return a.jsxs("div",{className:"py-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:N.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(be,{variant:"outline",children:N.pointType==="ambient"?"Ambiente":"Attrezzatura"}),a.jsx(be,{variant:$?"default":"destructive",children:$?"Completato":"Incompleto"})]})]})}),a.jsx(re,{variant:"outline",onClick:()=>f(N),children:$?"Modifica Manutenzioni":"Assegna manutenzioni"})]}),a.jsx("div",{className:"mt-2 grid gap-2 md:grid-cols-2",children:P.map(F=>{const E=it.find(p=>p.value===F.manutenzione);return a.jsxs("div",{className:"rounded border border-gray-200 bg-gray-50 p-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:E?.icon}),a.jsx("span",{className:"font-medium",children:E?.label})]}),a.jsxs("div",{className:"mt-1 text-gray-600",children:[pn.find(p=>p.value===F.frequenza)?.label," - ",F.assegnatoARuolo,F.assegnatoACategoria&&F.assegnatoACategoria!=="all"&&a.jsxs(a.Fragment,{children:[" - ",F.assegnatoACategoria]})]})]},F.id)})})]},N.id)})})]})}),a.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6",children:_()}),x&&S(),a.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4 text-sm text-blue-800",children:"ℹ️ Le attività configurate verranno automaticamente assegnate al personale secondo la frequenza indicata e monitorate nel sistema principale."})]})},Xd=({conservationPoint:e,staffOptions:t,maintenancePlans:n,onSave:r,onCancel:s})=>{const i=e.pointType==="ambient"?it.filter(w=>w.value!=="sbrinamento"):it,o=n.filter(w=>w.conservationPointId===e.id),[l,c]=m.useState(()=>i.map(w=>{const f=o.find(v=>v.manutenzione===w.value);return f||{id:`plan-${w.value}-${e.id}`,conservationPointId:e.id,manutenzione:w.value,frequenza:w.value==="rilevamento_temperatura"?"giornaliera":w.value==="sanificazione"?"settimanale":w.value==="sbrinamento"?"annuale":"custom",assegnatoARuolo:"dipendente",giorniCustom:w.value==="controllo_scadenze"?["lunedi","giovedi"]:void 0}})),[d,u]=m.useState({}),x=(w,f)=>{c(v=>v.map((h,j)=>j===w?{...h,...f}:h))},b=()=>{const w={};return l.forEach((f,v)=>{f.frequenza||(w[`plan-${v}-frequenza`]="Frequenza obbligatoria"),f.assegnatoARuolo||(w[`plan-${v}-ruolo`]="Ruolo obbligatorio"),f.frequenza==="custom"&&(!f.giorniCustom||f.giorniCustom.length===0)&&(w[`plan-${v}-giorni`]="Seleziona almeno un giorno per frequenza custom")}),u(w),Object.keys(w).length===0},C=()=>{b()&&r(l)};return a.jsxs("div",{className:"space-y-6",children:[i.map((w,f)=>{const v=l[f];return a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("span",{className:"text-2xl",children:w.icon}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:w.label}),a.jsx("p",{className:"text-sm text-gray-500",children:"Configura frequenza e assegnazione per questa manutenzione"})]})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{children:"Frequenza *"}),a.jsxs(Ee,{value:v.frequenza,onValueChange:h=>x(f,{frequenza:h,giorniCustom:h==="custom"?["lunedi"]:void 0}),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona frequenza"})}),a.jsx(Ne,{children:pn.map(h=>a.jsx(ae,{value:h.value,children:h.label},h.value))})]}),d[`plan-${f}-frequenza`]&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d[`plan-${f}-frequenza`]})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Ruolo *"}),a.jsxs(Ee,{value:v.assegnatoARuolo||"",onValueChange:h=>x(f,{assegnatoARuolo:h,assegnatoADipendenteSpecifico:void 0}),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona ruolo"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"admin",children:"Amministratore"}),a.jsx(ae,{value:"responsabile",children:"Responsabile"}),a.jsx(ae,{value:"dipendente",children:"Dipendente"}),a.jsx(ae,{value:"collaboratore",children:"Collaboratore"})]})]}),d[`plan-${f}-ruolo`]&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d[`plan-${f}-ruolo`]})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Categoria"}),a.jsxs(Ee,{value:v.assegnatoACategoria||"all",onValueChange:h=>x(f,{assegnatoACategoria:h,assegnatoADipendenteSpecifico:void 0}),disabled:!v.assegnatoARuolo,children:[a.jsx(je,{children:a.jsx(Re,{placeholder:v.assegnatoARuolo?"Seleziona categoria":"Prima seleziona un ruolo"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"all",children:"Tutte le categorie"}),t.filter(h=>h.role===v.assegnatoARuolo).flatMap(h=>h.categories).filter(h=>h&&h.trim()!=="").filter((h,j,A)=>A.indexOf(h)===j).map(h=>a.jsx(ae,{value:h,children:h},h))]})]})]}),v.assegnatoARuolo&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Dipendente specifico"}),a.jsxs(Ee,{value:v.assegnatoADipendenteSpecifico??"none",onValueChange:h=>x(f,{assegnatoADipendenteSpecifico:h}),disabled:!1,children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Opzionale: seleziona dipendente specifico"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"none",children:"Nessun dipendente specifico"}),t.filter(h=>h.role!==v.assegnatoARuolo?!1:v.assegnatoACategoria&&v.assegnatoACategoria!=="all"?h.categories.includes(v.assegnatoACategoria):!0).map(h=>a.jsxs(ae,{value:h.id,children:[h.label," - ",h.categories.join(", ")]},h.id))]})]})]}),v.frequenza==="custom"&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Giorni della settimana *"}),a.jsx("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:ai.map(h=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:v.giorniCustom?.includes(h.value)??!1,onChange:j=>{const A=v.giorniCustom||[],y=j.target.checked?[...A,h.value]:A.filter(T=>T!==h.value);x(f,{giorniCustom:y})},className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm",children:h.label})]},h.value))}),d[`plan-${f}-giorni`]&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d[`plan-${f}-giorni`]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Note (opzionale)"}),a.jsx(qt,{rows:2,value:v.note??"",onChange:h=>x(f,{note:h.target.value}),placeholder:"Note aggiuntive..."})]})]})]},v.id)}),a.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[a.jsx(re,{variant:"outline",onClick:s,children:"Annulla"}),a.jsx(re,{onClick:C,children:"Salva Manutenzioni"})]})]})},Qd=({task:e,staffOptions:t,isEditing:n,onUpdate:r,onDelete:s,onConfirm:i})=>{const[o,l]=m.useState({}),c=d=>{r(d);const u={};!d.name&&!e.name&&(u.name="Nome attività obbligatorio"),!d.frequenza&&!e.frequenza&&(u.frequenza="Frequenza obbligatoria"),!d.assegnatoARuolo&&!e.assegnatoARuolo&&(u.ruolo="Ruolo obbligatorio"),d.frequenza==="custom"&&(!d.giorniCustom||d.giorniCustom.length===0)&&(u.giorni="Seleziona almeno un giorno per frequenza custom"),l(u)};return a.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:n?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:e.name?`Modifica: ${e.name}`:"Nuova Attività Generica"}),a.jsx(re,{variant:"destructive",size:"icon",onClick:s,children:a.jsx(Qe,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx(K,{children:"Nome attività *"}),a.jsx(Ve,{value:e.name,onChange:d=>c({name:d.target.value}),placeholder:"Es: Pulizia cucina, Controllo fornelli...","aria-invalid":!!o.name}),o.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.name})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Frequenza *"}),a.jsxs(Ee,{value:e.frequenza,onValueChange:d=>c({frequenza:d,giorniCustom:d==="custom"?["lunedi"]:void 0}),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona frequenza"})}),a.jsx(Ne,{children:pn.map(d=>a.jsx(ae,{value:d.value,children:d.label},d.value))})]}),o.frequenza&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.frequenza})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Ruolo *"}),a.jsxs(Ee,{value:e.assegnatoARuolo||"",onValueChange:d=>c({assegnatoARuolo:d,assegnatoADipendenteSpecifico:void 0}),children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Seleziona ruolo"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"admin",children:"Amministratore"}),a.jsx(ae,{value:"responsabile",children:"Responsabile"}),a.jsx(ae,{value:"dipendente",children:"Dipendente"}),a.jsx(ae,{value:"collaboratore",children:"Collaboratore"})]})]}),o.ruolo&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.ruolo})]}),a.jsxs("div",{children:[a.jsx(K,{children:"Categoria"}),a.jsxs(Ee,{value:e.assegnatoACategoria||"all",onValueChange:d=>c({assegnatoACategoria:d,assegnatoADipendenteSpecifico:void 0}),disabled:!e.assegnatoARuolo,children:[a.jsx(je,{children:a.jsx(Re,{placeholder:e.assegnatoARuolo?"Seleziona categoria":"Prima seleziona un ruolo"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"all",children:"Tutte le categorie"}),t.filter(d=>d.role===e.assegnatoARuolo).flatMap(d=>d.categories).filter(d=>d&&d.trim()!=="").filter((d,u,x)=>x.indexOf(d)===u).map(d=>a.jsx(ae,{value:d,children:d},d))]})]})]}),e.assegnatoARuolo&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Dipendente specifico"}),a.jsxs(Ee,{value:e.assegnatoADipendenteSpecifico??"none",onValueChange:d=>c({assegnatoADipendenteSpecifico:d}),disabled:!1,children:[a.jsx(je,{children:a.jsx(Re,{placeholder:"Opzionale: seleziona dipendente specifico"})}),a.jsxs(Ne,{children:[a.jsx(ae,{value:"none",children:"Nessun dipendente specifico"}),t.filter(d=>d.role!==e.assegnatoARuolo?!1:e.assegnatoACategoria&&e.assegnatoACategoria!=="all"?d.categories.includes(e.assegnatoACategoria):!0).map(d=>a.jsxs(ae,{value:d.id,children:[d.label," - ",d.categories.join(", ")]},d.id))]})]})]}),e.frequenza==="custom"&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Giorni della settimana *"}),a.jsx("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:ai.map(d=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:e.giorniCustom?.includes(d.value)??!1,onChange:u=>{const x=e.giorniCustom||[],b=u.target.checked?[...x,d.value]:x.filter(C=>C!==d.value);c({giorniCustom:b})},className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm",children:d.label})]},d.value))}),o.giorni&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.giorni})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(K,{children:"Note (opzionale)"}),a.jsx(qt,{rows:2,value:e.note??"",onChange:d=>c({note:d.target.value}),placeholder:"Note aggiuntive..."})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4 mt-4",children:[a.jsx(re,{variant:"outline",onClick:s,children:"Annulla"}),a.jsx(re,{onClick:i,children:"Conferma Attività"})]})]}):null})},Jd={[ce.GLUTINE]:"Glutine",[ce.LATTE]:"Latte",[ce.UOVA]:"Uova",[ce.SOIA]:"Soia",[ce.FRUTTA_GUSCIO]:"Frutta a guscio",[ce.ARACHIDI]:"Arachidi",[ce.PESCE]:"Pesce",[ce.CROSTACEI]:"Crostacei"},eu=["kg","g","l","ml","pz","conf","buste","vaschette"],si=["active","expired","consumed","waste"];[...si];const tu=Tt({id:U(),name:U().min(2,"Nome categoria troppo corto"),color:U().regex(/^#[0-9A-Fa-f]{6}$/i,"Colore non valido"),description:U().optional(),conservationRules:Tt({minTemp:wt().min(-80).max(80),maxTemp:wt().min(-80).max(80),maxStorageDays:wt().min(1).max(365).optional(),requiresBlastChilling:ti().optional()})}),nu=Tt({id:U(),name:U().min(2,"Il nome del prodotto è obbligatorio"),categoryId:U().min(1,"Seleziona una categoria").optional(),departmentId:U().optional(),conservationPointId:U().optional(),sku:U().optional(),barcode:U().optional(),supplierName:U().optional(),purchaseDate:U().optional(),expiryDate:U().optional(),quantity:wt().nonnegative({message:"La quantità deve essere positiva"}).optional(),unit:U().optional(),allergens:pt(Ld(ce)).default([]),labelPhotoUrl:U().optional(),status:Ke(si),notes:U().optional()}),va={name:"Inserisci il nome del prodotto",categoryId:"Seleziona una categoria di appartenenza",departmentId:"Seleziona un reparto di riferimento",conservationPointId:"Associa un punto di conservazione",quantity:"La quantità è obbligatoria",unit:"Seleziona l'unità di misura",purchaseDate:"Seleziona la data di acquisto",expiryDate:"Seleziona la data di scadenza"},ru=["quantity"],au=["name","categoryId","departmentId","conservationPointId","unit","purchaseDate","expiryDate"],su=e=>{const t={};return au.forEach(n=>{const r=e[n];(!r||typeof r=="string"&&r.trim()==="")&&(t[n]=va[n])}),ru.forEach(n=>{const r=e[n];(r==null||Number.isNaN(r))&&(t[n]=va[n])}),t},iu=(e,t)=>{const n=tu.safeParse(e);if(!n.success){const i={};return n.error.issues.forEach(o=>{const l=o.path.join(".");i[l]=o.message}),{success:!1,errors:i}}const{minTemp:r,maxTemp:s}=e.conservationRules;return r>=s?{success:!1,errors:{minTemp:"La temperatura minima deve essere inferiore alla massima",maxTemp:"La temperatura massima deve essere superiore alla minima"}}:t.some(i=>i.id!==e.id&&i.name.trim().toLowerCase()===e.name.trim().toLowerCase())?{success:!1,errors:{name:"Una categoria con questo nome esiste già"}}:{success:!0}},ou=(e,t,n)=>{const r=nu.safeParse(e),s=su(e);if(!r.success||Object.keys(s).length>0){const i={...s};return r.success||r.error.issues.forEach(o=>{const l=o.path.join(".");i[l]||(i[l]=o.message)}),{success:!1,errors:i}}if(e.categoryId){const i=t.find(o=>o.id===e.categoryId);if(!i)return{success:!1,errors:{categoryId:"Categoria selezionata non valida"}};if(e.conservationPointId){const o=n.find(l=>l.id===e.conservationPointId);if(o){const{minTemp:l,maxTemp:c,requiresBlastChilling:d}=i.conservationRules;if(o.targetTemperature<l||o.targetTemperature>c)return{success:!1,errors:{conservationPointId:"Il punto di conservazione non rispetta il range di temperatura richiesto"}};if(d&&!o.isBlastChiller)return{success:!1,errors:{conservationPointId:"La categoria richiede un abbattitore di temperatura"}}}}}if(e.purchaseDate&&e.expiryDate){const i=new Date(e.purchaseDate),o=new Date(e.expiryDate);if(i>=o)return{success:!1,errors:{expiryDate:"La data di scadenza deve essere successiva alla data di acquisto"}}}return{success:!0}},ii=e=>`${e}_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,ba={fromExisting(e){return e?{...e,color:e.color??"#3b82f6",conservationRules:{minTemp:e.conservationRules.minTemp??0,maxTemp:e.conservationRules.maxTemp??4,maxStorageDays:e.conservationRules.maxStorageDays,requiresBlastChilling:e.conservationRules.requiresBlastChilling??!1}}:{id:ii("cat"),name:"",color:"#3b82f6",conservationRules:{minTemp:0,maxTemp:4,maxStorageDays:void 0,requiresBlastChilling:!1}}}},lu={fromExisting(e){return e?{...e,allergens:e.allergens??[]}:{id:ii("prod"),name:"",status:"active",allergens:[]}}},ya=e=>({id:e.id,name:e.name.trim(),categoryId:e.categoryId||void 0,departmentId:e.departmentId||void 0,conservationPointId:e.conservationPointId||void 0,sku:e.sku?.trim()||void 0,barcode:e.barcode?.trim()||void 0,supplierName:e.supplierName?.trim()||void 0,purchaseDate:e.purchaseDate?.trim()||void 0,expiryDate:e.expiryDate?.trim()||void 0,quantity:e.quantity,unit:e.unit?.trim()||void 0,allergens:e.allergens??[],labelPhotoUrl:e.labelPhotoUrl?.trim()||void 0,status:e.status,complianceStatus:e.complianceStatus,notes:e.notes?.trim()||void 0}),cu=e=>Jd[e]||e,du=(e,t,n)=>{if(!e.categoryId||!e.conservationPointId)return{compliant:!1,message:"Associa categoria e punto di conservazione per verificare la conformità"};const r=t.find(c=>c.id===e.categoryId),s=n.find(c=>c.id===e.conservationPointId);if(!r||!s)return{compliant:!1,message:"Dati insufficienti per la verifica HACCP"};const{minTemp:i,maxTemp:o,requiresBlastChilling:l}=r.conservationRules;return s.targetTemperature<i||s.targetTemperature>o?{compliant:!1,message:`Temperatura ${s.targetTemperature}°C fuori range (${i}°C - ${o}°C)`}:l&&!s.isBlastChiller?{compliant:!1,message:"La categoria richiede un abbattitore certificato"}:{compliant:!0,message:"Configurazione conforme alle regole HACCP"}},uu=[{value:ce.GLUTINE,label:"Glutine"},{value:ce.LATTE,label:"Latte"},{value:ce.UOVA,label:"Uova"},{value:ce.SOIA,label:"Soia"},{value:ce.FRUTTA_GUSCIO,label:"Frutta a guscio"},{value:ce.ARACHIDI,label:"Arachidi"},{value:ce.PESCE,label:"Pesce"},{value:ce.CROSTACEI,label:"Crostacei"}],mu=({data:e,departments:t,conservationPoints:n,onUpdate:r,onValidChange:s})=>{const[i,o]=m.useState((e?.categories??[]).map(p=>ba.fromExisting(p))),[l,c]=m.useState((e?.products??[]).map(ya)),[d,u]=m.useState("categories"),[x,b]=m.useState(null),[C,w]=m.useState({}),[f,v]=m.useState(null),[h,j]=m.useState({});m.useEffect(()=>{r({categories:i,products:l})},[i,l,r]),m.useEffect(()=>{s(l.length>0)},[l.length,s]);const A=m.useMemo(()=>t.filter(p=>p.is_active),[t]),y=m.useMemo(()=>l.reduce((p,g)=>(p[g.id]=du(g,i,n),p),{}),[l,i,n]),T=p=>{b(ba.fromExisting(p)),w({})},S=()=>{b(null),w({})},_=()=>{if(!x)return;const p=iu(x,i);if(!p.success){w(p.errors??{});return}o(g=>{const R=g.findIndex(O=>O.id===x.id);if(R>=0){const O=[...g];return O[R]=x,O}return[...g,x]}),S()},N=p=>{o(g=>g.filter(R=>R.id!==p)),c(g=>g.map(R=>R.categoryId===p?{...R,categoryId:void 0}:R))},P=p=>{v(lu.fromExisting(p)),j({})},L=()=>{v(null),j({})},$=()=>{if(!f)return;const p=ya(f),g=ou(p,i,n);if(!g.success){j(g.errors??{});return}c(R=>{const O=R.findIndex(I=>I.id===p.id);if(O>=0){const I=[...R];return I[O]=p,I}return[...R,p]}),L()},F=p=>{c(g=>g.filter(R=>R.id!==p))},E=p=>{v(g=>g&&{...g,allergens:g.allergens.includes(p)?g.allergens.filter(R=>R!==p):[...g.allergens,p]})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("header",{className:"text-center space-y-2",children:[a.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-blue-100",children:a.jsx(Pt,{className:"h-8 w-8 text-blue-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestione Inventario"}),a.jsx("p",{className:"text-gray-600",children:"Configura categorie prodotti e inventario iniziale per il controllo HACCP"})]}),a.jsxs("div",{className:"flex space-x-1 rounded-lg bg-gray-100 p-1",children:[a.jsxs("button",{type:"button",onClick:()=>u("categories"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${d==="categories"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(_r,{className:"mr-2 inline h-4 w-4"}),"Categorie Prodotti"]}),a.jsxs("button",{type:"button",onClick:()=>u("products"),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${d==="products"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Pt,{className:"mr-2 inline h-4 w-4"}),"Prodotti"]})]}),d==="categories"&&a.jsxs("section",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Categorie configurate (",i.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Ogni categoria definisce i range termici e i requisiti HACCP"})]}),a.jsxs("button",{type:"button",onClick:()=>T(),className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(lt,{className:"h-4 w-4"})," Nuova categoria"]})]}),i.length===0?a.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center text-gray-500",children:"Nessuna categoria configurata. Aggiungi la prima categoria per iniziare."}):a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:i.map(p=>a.jsx("article",{className:"rounded-lg border border-gray-200 bg-white p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("span",{className:"h-4 w-4 rounded-full",style:{backgroundColor:p.color}}),a.jsx("h4",{className:"font-medium text-gray-900",children:p.name})]}),p.description&&a.jsx("p",{className:"mb-2 text-sm text-gray-600",children:p.description}),a.jsxs("dl",{className:"space-y-1 text-xs text-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Range:"}),a.jsxs("span",{children:[p.conservationRules.minTemp,"°C ➝"," ",p.conservationRules.maxTemp,"°C"]})]}),p.conservationRules.maxStorageDays&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Durata max:"}),a.jsxs("span",{children:[p.conservationRules.maxStorageDays," giorni"]})]}),p.conservationRules.requiresBlastChilling&&a.jsx("div",{className:"flex items-center gap-2 text-amber-600",children:"⚡ Richiede abbattitore"})]})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>T(p),className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Modifica categoria",children:a.jsx(ot,{className:"h-4 w-4"})}),a.jsx("button",{type:"button",onClick:()=>N(p.id),className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Elimina categoria",children:a.jsx(Qe,{className:"h-4 w-4"})})]})]})},p.id))}),x&&a.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:[a.jsx("h4",{className:"mb-4 text-sm font-semibold text-blue-900",children:i.some(p=>p.id===x.id)?"Modifica categoria":"Nuova categoria"}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Nome *"}),a.jsx("input",{type:"text",value:x.name,onChange:p=>b(g=>g&&{...g,name:p.target.value}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${C.name?"border-red-300":"border-blue-200"}`}),C.name&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:C.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Colore"}),a.jsx("input",{type:"color",value:x.color,onChange:p=>b(g=>g&&{...g,color:p.target.value}),className:"h-10 w-full cursor-pointer rounded-md border border-blue-200"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Descrizione"}),a.jsx("textarea",{value:x.description??"",onChange:p=>b(g=>g&&{...g,description:p.target.value}),rows:3,className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",placeholder:"Descrizione opzionale"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Temp. minima *"}),a.jsx("input",{type:"number",step:"0.1",value:x.conservationRules.minTemp,onChange:p=>b(g=>g&&{...g,conservationRules:{...g.conservationRules,minTemp:Number(p.target.value)}}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Temp. massima *"}),a.jsx("input",{type:"number",step:"0.1",value:x.conservationRules.maxTemp,onChange:p=>b(g=>g&&{...g,conservationRules:{...g.conservationRules,maxTemp:Number(p.target.value)}}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${C["conservationRules.maxTemp"]?"border-red-300":"border-blue-200"}`}),C["conservationRules.maxTemp"]&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:C["conservationRules.maxTemp"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Durata max (gg)"}),a.jsx("input",{type:"number",min:1,value:x.conservationRules.maxStorageDays??"",onChange:p=>b(g=>g&&{...g,conservationRules:{...g.conservationRules,maxStorageDays:p.target.value?Number(p.target.value):void 0}}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("input",{id:"requiresBlastChilling",type:"checkbox",checked:x.conservationRules.requiresBlastChilling??!1,onChange:p=>b(g=>g&&{...g,conservationRules:{...g.conservationRules,requiresBlastChilling:p.target.checked}}),className:"h-4 w-4 rounded border-blue-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"requiresBlastChilling",className:"text-sm text-blue-900",children:"Richiede abbattitore"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:S,className:"rounded-lg px-4 py-2 text-sm text-blue-900 hover:bg-blue-100",children:"Annulla"}),a.jsx("button",{type:"button",onClick:_,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700",children:"Salva categoria"})]})]})]}),d==="products"&&a.jsxs("section",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Prodotti configurati (",l.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Ogni prodotto viene validato secondo le regole HACCP di categoria"})]}),a.jsxs("button",{type:"button",onClick:()=>P(),className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(lt,{className:"h-4 w-4"})," Nuovo prodotto"]})]}),l.length===0?a.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center text-gray-500",children:"Nessun prodotto configurato. Aggiungi un prodotto per proseguire."}):a.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.map(p=>{const g=i.find(z=>z.id===p.categoryId),R=t.find(z=>z.id===p.departmentId),O=n.find(z=>z.id===p.conservationPointId),I=y[p.id];return a.jsx("article",{className:"rounded-lg border border-gray-200 bg-white p-4",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:p.name}),p.quantity!==void 0&&a.jsxs("span",{className:"text-sm text-gray-500",children:[p.quantity," ",p.unit??"pz"]}),a.jsx("span",{className:`rounded-full px-2 py-1 text-xs capitalize ${p.status==="active"?"bg-green-100 text-green-800":p.status==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-700"}`,children:p.status})]}),a.jsxs("dl",{className:"grid grid-cols-1 gap-1 text-xs text-gray-600 md:grid-cols-3",children:[g&&a.jsxs("div",{children:[a.jsx("dt",{className:"font-semibold",children:"Categoria:"}),a.jsx("dd",{children:g.name})]}),R&&a.jsxs("div",{children:[a.jsx("dt",{className:"font-semibold",children:"Reparto:"}),a.jsx("dd",{children:R.name})]}),O&&a.jsxs("div",{children:[a.jsx("dt",{className:"font-semibold",children:"Conservazione:"}),a.jsxs("dd",{children:[O.name," (",O.targetTemperature,"°C)"]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[p.supplierName&&a.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-1",children:p.supplierName}),p.expiryDate&&a.jsxs("span",{className:"rounded-full bg-amber-100 px-2 py-1 text-amber-700",children:["Scadenza: ",p.expiryDate]}),p.allergens.length>0&&a.jsxs("span",{className:"rounded-full bg-red-100 px-2 py-1 text-red-700",children:["Allergeni:"," ",p.allergens.map(cu).join(", ")]})]}),p.labelPhotoUrl&&a.jsx("a",{href:p.labelPhotoUrl,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-xs text-blue-600 hover:underline",children:"Visualizza etichetta"}),a.jsx("div",{className:`rounded-md border px-3 py-2 text-xs ${I.compliant?"border-green-200 bg-green-50 text-green-700":"border-amber-200 bg-amber-50 text-amber-700"}`,children:I.message}),p.notes&&a.jsx("p",{className:"border-l-2 border-blue-200 pl-3 text-sm text-gray-500",children:p.notes})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>P(p),className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Modifica prodotto",children:a.jsx(ot,{className:"h-4 w-4"})}),a.jsx("button",{type:"button",onClick:()=>F(p.id),className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Elimina prodotto",children:a.jsx(Qe,{className:"h-4 w-4"})})]})]})},p.id)})}),f&&a.jsxs("div",{className:"space-y-6 rounded-lg border border-blue-200 bg-blue-50 p-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(Pt,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-blue-900",children:l.some(p=>p.id===f.id)?"Modifica Prodotto":"Nuovo Prodotto"}),a.jsx("p",{className:"text-sm text-blue-600",children:l.some(p=>p.id===f.id)?"Aggiorna le informazioni del prodotto":"Aggiungi un nuovo prodotto all'inventario"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-medium text-blue-900 flex items-center gap-2",children:[a.jsx(Pt,{className:"w-5 h-5"}),"Informazioni Base"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Nome prodotto *"}),a.jsx("input",{type:"text",value:f.name,onChange:p=>v(g=>g&&{...g,name:p.target.value}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${h.name?"border-red-300":"border-blue-200"}`}),h.name&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.name})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"SKU"}),a.jsx("input",{type:"text",value:f.sku??"",onChange:p=>v(g=>g&&{...g,sku:p.target.value}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Barcode"}),a.jsx("input",{type:"text",value:f.barcode??"",onChange:p=>v(g=>g&&{...g,barcode:p.target.value}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500"})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-medium text-blue-900 flex items-center gap-2",children:[a.jsx(_r,{className:"w-5 h-5"}),"Categoria e Posizione"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Categoria"}),a.jsxs("select",{value:f.categoryId??"",onChange:p=>v(g=>g&&{...g,categoryId:p.target.value||void 0}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Seleziona categoria"}),i.map(p=>a.jsx("option",{value:p.id,children:p.name},p.id))]}),h.categoryId&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.categoryId})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Reparto"}),a.jsxs("select",{value:f.departmentId??"",onChange:p=>v(g=>g&&{...g,departmentId:p.target.value||void 0}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Seleziona reparto"}),A.map(p=>a.jsx("option",{value:p.id,children:p.name},p.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Conservazione"}),a.jsxs("select",{value:f.conservationPointId??"",onChange:p=>v(g=>g&&{...g,conservationPointId:p.target.value||void 0}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${h.conservationPointId?"border-red-300":"border-blue-200"}`,children:[a.jsx("option",{value:"",children:"Seleziona punto conservazione"}),n.map(p=>a.jsxs("option",{value:p.id,children:[p.name," (",p.targetTemperature,"°C)"]},p.id))]}),h.conservationPointId&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.conservationPointId})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-medium text-blue-900 flex items-center gap-2",children:[a.jsx(Ca,{className:"w-5 h-5"}),"Date e Quantità"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Data Acquisto"}),a.jsx("input",{type:"date",value:f?.purchaseDate??"",onChange:p=>v(g=>g&&{...g,purchaseDate:p.target.value||void 0}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Data Scadenza"}),a.jsx("input",{type:"date",value:f?.expiryDate??"",onChange:p=>v(g=>g&&{...g,expiryDate:p.target.value||void 0}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${h.expiryDate?"border-red-300":"border-blue-200"}`}),h.expiryDate&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.expiryDate})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Quantità"}),a.jsx("input",{type:"number",min:0,step:"0.001",value:f.quantity??"",onChange:p=>v(g=>g&&{...g,quantity:p.target.value?Number(p.target.value):void 0}),className:`w-full rounded-md border px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 ${h.quantity?"border-red-300":"border-blue-200"}`}),h.quantity&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.quantity})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Unità"}),a.jsx("select",{value:f.unit??"pz",onChange:p=>v(g=>g&&{...g,unit:p.target.value}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",children:eu.map(p=>a.jsx("option",{value:p,children:p},p))})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-medium text-blue-900 flex items-center gap-2 mb-4",children:[a.jsx(pi,{className:"w-5 h-5"}),"Allergeni"]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:uu.map(p=>a.jsxs("label",{className:"flex items-center gap-2 p-3 border border-blue-200 rounded-lg hover:bg-blue-50/50 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:f?.allergens.includes(p.value)||!1,onChange:()=>E(p.value),className:"w-4 h-4 text-blue-600 border-blue-300 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:p.label})]},p.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"URL Foto Etichetta"}),a.jsx("input",{type:"url",value:f?.labelPhotoUrl??"",onChange:p=>v(g=>g&&{...g,labelPhotoUrl:p.target.value}),className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",placeholder:"https://..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-blue-900",children:"Note"}),a.jsx("textarea",{value:f.notes??"",onChange:p=>v(g=>g&&{...g,notes:p.target.value}),rows:3,className:"w-full rounded-md border border-blue-200 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500",placeholder:"Informazioni aggiuntive"})]}),a.jsxs("div",{className:"flex justify-end gap-3 border-t border-blue-200 pt-4",children:[a.jsx("button",{type:"button",onClick:L,className:"rounded-lg px-4 py-2 text-sm text-blue-900 hover:bg-blue-100",children:"Annulla"}),a.jsx("button",{type:"button",onClick:$,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700",children:"Salva prodotto"})]})]})]})]})},Kt=[{id:0,title:"Informazioni Aziendali",description:"Dati base della tua azienda",icon:Mt},{id:1,title:"Reparti",description:"Organizzazione aziendale",icon:Sa},{id:2,title:"Personale",description:"Staff e responsabilità",icon:hi},{id:3,title:"Conservazione",description:"Punti di controllo temperatura",icon:Fn},{id:4,title:"Attività",description:"Task e manutenzioni",icon:gi},{id:5,title:"Inventario",description:"Prodotti e categorie",icon:Pt}],fu=({currentStep:e,totalSteps:t,onStepClick:n})=>{const r=i=>i<e?"completed":i===e?"current":"upcoming",s=i=>{switch(i){case"completed":return{container:"border-green-200 bg-green-50",icon:"bg-green-600 text-white",text:"text-green-900",description:"text-green-600"};case"current":return{container:"border-blue-200 bg-blue-50 ring-2 ring-blue-500 ring-opacity-50",icon:"bg-blue-600 text-white",text:"text-blue-900",description:"text-blue-600"};default:return{container:"border-gray-200 bg-gray-50",icon:"bg-gray-300 text-gray-600",text:"text-gray-500",description:"text-gray-400"}}};return a.jsxs("div",{className:"mb-8",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-6",children:Kt.map(i=>{const o=r(i.id),l=s(o),c=i.icon;return a.jsxs("button",{onClick:()=>n(i.id),disabled:i.id>e,className:`
                  p-4 rounded-lg border-2 transition-all duration-200 text-left
                  ${l.container}
                  ${i.id<=e?"hover:shadow-md cursor-pointer":"cursor-not-allowed"}
                `,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("div",{className:`
                    w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium
                    ${l.icon}
                  `,children:o==="completed"?a.jsx("span",{children:"✓"}):a.jsx(c,{className:"w-4 h-4"})}),a.jsx("span",{className:`ml-2 text-xs font-medium ${l.text}`,children:i.id+1})]}),a.jsx("h3",{className:`text-sm font-semibold mb-1 ${l.text}`,children:i.title}),a.jsx("p",{className:`text-xs ${l.description}`,children:i.description})]},i.id)})})}),a.jsxs("div",{className:"md:hidden",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Passo ",e+1," di ",t]}),a.jsxs("span",{className:"text-sm text-gray-400",children:[Math.round((e+1)/t*100),"% completato"]})]}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`
              w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium
              bg-blue-600 text-white
            `,children:xe.createElement(Kt[e].icon,{className:"w-5 h-5"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-base font-semibold text-gray-900",children:Kt[e].title}),a.jsx("p",{className:"text-sm text-gray-500",children:Kt[e].description})]})]})}),a.jsx("div",{className:"flex justify-center mt-4 space-x-2",children:Array.from({length:t}).map((i,o)=>{const l=r(o);return a.jsx("button",{onClick:()=>n(o),disabled:o>e,className:`
                  w-3 h-3 rounded-full transition-all duration-200
                  ${l==="completed"?"bg-green-500":l==="current"?"bg-blue-500":"bg-gray-300"}
                  ${o<=e?"cursor-pointer":"cursor-not-allowed"}
                `},o)})})]})]})},pu=({onPrefillOnboarding:e,onResetOnboarding:t,onCompleteOnboarding:n,isDevMode:r=!1})=>(m.useEffect(()=>{r&&console.log("DevButtons loaded in dev mode")},[r]),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-green-600 bg-white border border-green-200 rounded-md hover:text-green-700 hover:bg-green-50 transition-colors",title:"Precompila onboarding con dati di test",children:[a.jsx(Sa,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Precompila"}),a.jsx("span",{className:"sm:hidden",children:"Precompila"})]}),a.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-200 rounded-md hover:text-blue-700 hover:bg-blue-50 transition-colors",title:"Completa onboarding automaticamente",children:[a.jsx(xi,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Completa Onboarding"}),a.jsx("span",{className:"sm:hidden",children:"Completa"})]}),a.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 bg-white border border-red-200 rounded-md hover:text-red-700 hover:bg-red-50 transition-colors",title:"Reset completo onboarding e app",children:[a.jsx(vi,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Reset Onboarding"}),a.jsx("span",{className:"sm:hidden",children:"Reset"})]})]})),It=6,ju=()=>{const e=ji(),{companyId:t}=Ci(),[n,r]=m.useState(0),[s,i]=m.useState({}),[o,l]=m.useState(!1),[c,d]=m.useState(!1),[u,x]=m.useState(!1);m.useEffect(()=>{const E=localStorage.getItem("onboarding-data");if(E)try{const p=JSON.parse(E);i(p)}catch(p){console.error("Error parsing saved onboarding data:",p)}},[]);const b=m.useCallback(()=>{try{const E=_a();i(E),Te.success("Dati precompilati caricati!")}catch(E){console.error("Error prefilling onboarding:",E),Te.error("Errore durante la precompilazione")}},[]),C=m.useCallback(()=>{Ri()},[]),w=m.useCallback(()=>{Ei()},[]),f=m.useRef();m.useEffect(()=>(f.current&&clearTimeout(f.current),Object.keys(s).length>0&&(f.current=setTimeout(()=>{localStorage.setItem("onboarding-data",JSON.stringify(s))},500)),()=>{f.current&&clearTimeout(f.current)}),[s]);const v=m.useCallback((E,p)=>{i(g=>({...g,[E]:p}))},[]),h=m.useCallback(E=>{l(E)},[]),j=m.useCallback(E=>{v("tasks",E)},[v]),A=m.useCallback(E=>{v("conservation",E)},[v]),y=m.useCallback(E=>{v("staff",E)},[v]),T=async()=>{if(!o){Te.error("Completa tutti i campi obbligatori prima di continuare");return}n<It-1?r(E=>E+1):await _()},S=()=>{n>0&&r(E=>E-1)},_=async()=>{x(!0),d(!0);try{await $();const{error:E}=await Ue.from("companies").update({onboarding_completed:!0,onboarding_completed_at:new Date().toISOString()}).eq("id",t);if(E)throw E;localStorage.removeItem("onboarding-data"),Te.success("Onboarding completato con successo!"),e("/")}catch(E){console.error("Error completing onboarding:",E),Te.error("Errore durante il completamento dell'onboarding")}finally{x(!1),d(!1)}},N=E=>({rilevamento_temperatura:"temperature_monitoring",sanificazione:"sanitation",sbrinamento:"defrosting",controllo_scadenze:"expiry_check"})[E]||"general_maintenance",P=E=>({giornaliera:"daily",settimanale:"weekly",mensile:"monthly",annuale:"annual",custom:"custom"})[E]||"weekly",L=E=>{const p=new Date;switch(E){case"giornaliera":return new Date(p.setDate(p.getDate()+1)).toISOString();case"settimanale":return new Date(p.setDate(p.getDate()+7)).toISOString();case"mensile":return new Date(p.setMonth(p.getMonth()+1)).toISOString();case"annuale":return new Date(p.setFullYear(p.getFullYear()+1)).toISOString();default:return new Date(p.setDate(p.getDate()+7)).toISOString()}},$=async()=>{if(!t)throw new Error("Company ID not found");if(s.business){const{error:E}=await Ue.from("companies").update({...s.business,updated_at:new Date().toISOString()}).eq("id",t);if(E)throw E}if(s.departments?.length){const E=s.departments.map(g=>({...g,company_id:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("departments").insert(E);if(p)throw p}if(s.staff?.length){const E=s.staff.map(g=>({company_id:t,name:g.fullName||`${g.name} ${g.surname}`,role:g.role,category:Array.isArray(g.categories)?g.categories[0]||"Altro":g.category,email:g.email||null,phone:g.phone||null,hire_date:null,status:"active",notes:g.notes||null,haccp_certification:g.haccpExpiry?{level:"base",expiry_date:g.haccpExpiry,issuing_authority:"",certificate_number:""}:null,department_assignments:g.department_assignments||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("staff").insert(E);if(p)throw p}if(s.conservation?.points?.length){const E=s.conservation.points.map(g=>({company_id:t,department_id:g.departmentId,name:g.name,setpoint_temp:g.targetTemperature,type:g.pointType,product_categories:g.productCategories||[],is_blast_chiller:g.isBlastChiller||!1,status:"normal",maintenance_due:g.maintenanceDue||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("conservation_points").insert(E);if(p)throw p}if(s.tasks?.conservationMaintenancePlans?.length){const E=s.tasks.conservationMaintenancePlans.map(g=>({company_id:t,conservation_point_id:g.conservationPointId,type:N(g.manutenzione),frequency:P(g.frequenza),title:`Manutenzione: ${g.manutenzione}`,description:g.note||"",priority:"medium",status:"scheduled",next_due:L(g.frequenza),estimated_duration:60,instructions:[],assigned_to_staff_id:g.assegnatoARuolo==="specifico"?g.assegnatoADipendenteSpecifico:null,assigned_to_role:g.assegnatoARuolo!=="specifico"?g.assegnatoARuolo:null,assigned_to_category:g.assegnatoACategoria||null,assigned_to:g.assegnatoADipendenteSpecifico||g.assegnatoARuolo||"",assignment_type:g.assegnatoARuolo==="specifico"?"staff":"role",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("maintenance_tasks").insert(E);if(p)throw p}if(s.tasks?.genericTasks?.length){const E=s.tasks.genericTasks.map(g=>({company_id:t,name:g.name,frequency:P(g.frequenza),description:g.note||"",department_id:null,conservation_point_id:null,priority:"medium",estimated_duration:60,checklist:[],required_tools:[],haccp_category:null,next_due:L(g.frequenza),status:"pending",assigned_to_staff_id:g.assegnatoARuolo==="specifico"?g.assegnatoADipendenteSpecifico:null,assigned_to_role:g.assegnatoARuolo!=="specifico"?g.assegnatoARuolo:null,assigned_to_category:g.assegnatoACategoria||null,assigned_to:g.assegnatoADipendenteSpecifico||g.assegnatoARuolo||"",assignment_type:g.assegnatoARuolo==="specifico"?"staff":"role",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("tasks").insert(E);if(p)throw p}if(s.inventory?.products?.length){const E=s.inventory.products.map(g=>({...g,company_id:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:p}=await Ue.from("products").insert(E);if(p)throw p}},F=()=>{switch(n){case 0:return a.jsx(Ii,{data:s.business,onUpdate:E=>v("business",E),onValidChange:h});case 1:return a.jsx(Pi,{data:s.departments,onUpdate:E=>v("departments",E),onValidChange:h});case 2:return a.jsx(Fd,{data:s.staff,departments:s.departments||[],onUpdate:y,onValidChange:h});case 3:return a.jsx(Yd,{data:s.conservation,departments:s.departments||[],onUpdate:A,onValidChange:h});case 4:return a.jsx(Kd,{data:s.tasks,departments:s.departments||[],conservationPoints:s.conservation?.points||[],staff:s.staff||[],onUpdate:j,onValidChange:h});case 5:return a.jsx(mu,{data:s.inventory,departments:s.departments||[],conservationPoints:s.conservation?.points||[],onUpdate:E=>v("inventory",E),onValidChange:h});default:return null}};return a.jsx("div",{className:"min-h-screen bg-gray-50","data-testid":"onboarding-wizard",children:a.jsxs("div",{className:"max-w-4xl mx-auto py-6 px-4 sm:py-8",children:[a.jsxs("div",{className:"text-center mb-6 space-y-3 sm:mb-8",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 sm:text-3xl",children:"Configurazione Iniziale HACCP"}),a.jsx("p",{className:"text-sm text-gray-600 sm:text-base",children:"Configura la tua azienda per iniziare a utilizzare il sistema HACCP"}),a.jsx("div",{className:"flex flex-col items-center gap-2 sm:flex-row sm:justify-center",children:a.jsx(pu,{onPrefillOnboarding:b,onResetOnboarding:w,onCompleteOnboarding:C,isDevMode:!1})})]}),a.jsx(fu,{currentStep:n,totalSteps:It,onStepClick:r}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 mb-6",children:F()}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{type:"button",onClick:S,disabled:n===0,className:"px-6 py-2 text-gray-600 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Indietro"}),a.jsx("button",{type:"button",onClick:T,disabled:!o||c,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:u?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Completando..."]}):n===It-1?"Completa Configurazione":"Avanti"})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(n+1)/It*100}%`}})}),a.jsxs("p",{className:"text-center text-sm text-gray-500 mt-2",children:["Step ",n+1," di ",It]})]})]})})};export{ju as default};
